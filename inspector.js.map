{"version":3,"file":"inspector.js","sources":["../lib-src/inspector/inspect.mts","../lib-src/inspector/context.mts","../lib-src/inspector/internal-utils.mts","../lib-src/inspector/methods.mts","../lib-src/inspector/utils.mts","../lib-src/inspector/index.mts"],"sourcesContent":["import type { Protocol } from 'devtools-protocol';\nimport {\n  BigIntValue,\n  Descriptor,\n  evalQ,\n  Get,\n  IntrinsicsFunctionToString, isArrayBufferObject, isArrayExoticObject, IsCallable, isDataViewObject, isDateObject, isECMAScriptFunctionObject, isErrorObject, isIntegerIndex, isMapObject, isPromiseObject, isProxyExoticObject, isRegExpObject, isSetObject, isTypedArrayObject, isWeakMapObject, isWeakSetObject, JSStringValue, NumberValue, ObjectValue, PrivateElementRecord, PrivateName, R, surroundingAgent, SymbolDescriptiveString, SymbolValue, ToString, skipDebugger, UndefinedValue, Value, type ArrayBufferObject, type BooleanValue, type DataViewObject, type DateObject, type FunctionObject, type MapObject, type NullValue, type PromiseObject, type PropertyKeyValue, type ProxyObject, type RegExpObject, type SetObject, type TypedArrayObject,\n  type WeakMapObject,\n  type WeakSetObject,\n  type ModuleNamespaceObject,\n  isModuleNamespaceObject,\n  DataBlock,\n  TypedArrayGetElement,\n  TypedArrayLength,\n  MakeTypedArrayWithBufferWitnessRecord,\n  DateProto_toISOString,\n  ValueOfNormalCompletion,\n  NormalCompletion,\n  type ShadowRealmObject,\n  isShadowRealmObject,\n  isWrappedFunctionExoticObject,\n  ArrayExoticObjectInternalMethods,\n  F,\n} from '#self';\n\n/*\nTest code: copy this into the inspector console.\nprimitive: console.log('primitive:', null, undefined, true, false, 0, -0, NaN, Infinity, -Infinity, 1n, 'string', Symbol(), Symbol('text'), Symbol.for('global'), Symbol.iterator);\nfn: console.log('builtin:', eval, '\\nfunction:', function() { code }, '\\ngenerator:', function*() { code }, '\\nasync:', async function() { code }, '\\nasync generator:', async function*() { code }, '\\narrow:', () => { code }, '\\narrow async:', async () => { code });\n\nnormal: console.log('normal:', {}, new (class T { #a }), globalThis);\narraybuffer: console.log('arraybuffer:', new ArrayBuffer(8));\ndataview: console.log('dataview:', new DataView(new ArrayBuffer(8)));\nmap: console.log('map:', new Map(), new Map([[eval, globalThis], [1, 2]]));\nset: console.log('set:', new Set(), new Set([1, globalThis]));\nweakmap: console.log('weakmap:', new WeakMap(), new WeakMap([[{}, 1]]));\nweakset: console.log('weakset:', new WeakSet(), new WeakSet([{}]));\ndate: console.log('date:', new Date());\npromise: console.log('promise:', new Promise(() => {}), Promise.resolve(globalThis), Promise.reject(globalThis));\nproxy: {  const x = Proxy.revocable({}, {}); x.revoke(); console.log('proxy:', new Proxy({}, {}), new Proxy(function() {}, {}), x.proxy); }\nregexp: console.log('regexp:', /pattern/, new RegExp('pattern', 'g'));\narray: console.log('array:', [], [1, 2], Object.assign([1, 2], { a: 1 }), [0, ,,, 3]);\ntypedarray: console.log('typedarray:', new Int8Array(8), new Int16Array(8), new Int32Array(8), new Uint8Array(8), new Uint16Array(8), new Uint32Array(8), new Uint8ClampedArray(8), new Float32Array(8), new Float64Array(8), new BigInt64Array(8), new BigUint64Array(8));\n*/\ninterface Inspector<T extends Value> {\n    toRemoteObject(value: T, getObjectId: (val: SymbolValue | ObjectValue) => string, generatePreview: boolean | undefined): Protocol.Runtime.RemoteObject;\n    toObjectPreview(value: T): Protocol.Runtime.ObjectPreview;\n    toPropertyPreview(name: string, value: T): Protocol.Runtime.PropertyPreview;\n    toDescription(value: T): string;\n    toInternalProperties?(value: T, getObjectId: (val: SymbolValue | ObjectValue) => string, generatePreview: boolean | undefined): Protocol.Runtime.InternalPropertyDescriptor[];\n}\n\nconst Null: Inspector<NullValue> = {\n  toRemoteObject: () => ({ type: 'object', subtype: 'null', value: null }),\n  toObjectPreview: () => ({\n    type: 'object', subtype: 'null', properties: [], overflow: false,\n  }),\n  toPropertyPreview: (name) => ({\n    name, type: 'object', subtype: 'null', value: 'null',\n  }),\n  toDescription: () => '',\n};\n\nconst Undefined: Inspector<UndefinedValue> = {\n  toRemoteObject: () => ({ type: 'undefined' }),\n  toObjectPreview: () => ({\n    type: 'undefined', properties: [], overflow: false,\n  }),\n  toPropertyPreview: (name) => ({\n    name, type: 'undefined', value: 'undefined',\n  }),\n  toDescription: () => 'undefined',\n};\n\nconst Boolean: Inspector<BooleanValue> = {\n  toRemoteObject: (value) => ({ type: 'boolean', value: value.booleanValue() }),\n  toPropertyPreview: (name, value) => ({\n    name, type: 'boolean', value: value.booleanValue().toString(),\n  }),\n  toObjectPreview(value) {\n    return {\n      type: 'boolean',\n      value: value.booleanValue(),\n      description: value.booleanValue().toString(),\n      overflow: false,\n      properties: [],\n    };\n  },\n  toDescription: (value) => value.booleanValue().toString(),\n};\n\nconst Symbol: Inspector<SymbolValue> = {\n  toRemoteObject: (value, getObjectId) => ({\n    type: 'symbol',\n    description: SymbolDescriptiveString(value).stringValue(),\n    objectId: getObjectId(value),\n  }),\n  toPropertyPreview: (name, value) => ({\n    name, type: 'symbol', value: SymbolDescriptiveString(value).stringValue(),\n  }),\n  toObjectPreview: (value) => ({\n    type: 'symbol',\n    description: SymbolDescriptiveString(value).stringValue(),\n    overflow: false,\n    properties: [],\n  }),\n  toDescription: (value) => SymbolDescriptiveString(value).stringValue(),\n};\n\nconst String: Inspector<JSStringValue> = {\n  toRemoteObject: (value) => ({ type: 'string', value: value.stringValue() }),\n  toPropertyPreview(name, value) {\n    return {\n      name, type: 'string', value: value.stringValue(),\n    };\n  },\n  toObjectPreview(value) {\n    return {\n      type: 'string',\n      description: value.stringValue(),\n      overflow: false,\n      properties: [],\n    };\n  },\n  toDescription: (value) => value.stringValue(),\n};\n\nconst Number: Inspector<NumberValue> = {\n  toRemoteObject(value) {\n    const v = R(value);\n    let description = v.toString();\n    const isNeg0 = Object.is(v, -0);\n    // Includes values `-0`, `NaN`, `Infinity`, `-Infinity`, and bigint literals.\n    if (isNeg0 || !globalThis.Number.isFinite(v)) {\n      if (typeof v === 'bigint') {\n        description += 'n';\n        return { type: 'bigint', unserializableValue: description, description };\n      }\n      return { type: 'number', unserializableValue: description, description: isNeg0 ? '-0' : description };\n    }\n    return { type: 'number', value: v, description };\n  },\n  toPropertyPreview(name, value) {\n    return {\n      name, type: 'number', value: this.toDescription(value),\n    };\n  },\n  toObjectPreview(value) {\n    return {\n      type: 'number',\n      description: this.toDescription(value),\n      overflow: false,\n      properties: [],\n    };\n  },\n  toDescription: (value) => {\n    const r = R(value);\n    return value instanceof BigIntValue ? `${r}n` : r.toString();\n  },\n};\n\nfunction unwrapFunction(value: FunctionObject): FunctionObject {\n  if (isWrappedFunctionExoticObject(value)) {\n    return unwrapFunction(value.WrappedTargetFunction);\n  }\n  return value;\n}\nconst Function: Inspector<FunctionObject> = {\n  toRemoteObject(value, getObjectId) {\n    value = unwrapFunction(value);\n    const result: Protocol.Runtime.RemoteObject = {\n      type: 'function',\n      objectId: getObjectId(value),\n    };\n    result.description = IntrinsicsFunctionToString(value);\n    if (isECMAScriptFunctionObject(value) && value.ECMAScriptCode) {\n      if (value.ECMAScriptCode.type === 'FunctionBody') {\n        result.className = 'Function';\n      } else if (value.ECMAScriptCode.type === 'GeneratorBody') {\n        result.className = 'GeneratorFunction';\n      } else if (value.ECMAScriptCode.type === 'AsyncBody') {\n        result.className = 'AsyncFunction';\n      } else if (value.ECMAScriptCode.type === 'AsyncGeneratorBody') {\n        result.className = 'AsyncGeneratorFunction';\n      }\n    } else {\n      result.className = 'Function';\n    }\n    return result;\n  },\n  toPropertyPreview: (name) => ({ name, type: 'function', value: '' }),\n  toObjectPreview(value) {\n    return {\n      type: 'function',\n      description: IntrinsicsFunctionToString(value),\n      overflow: false,\n      properties: [],\n    };\n  },\n  toDescription: () => 'Function',\n};\n\nclass ObjectInspector<T extends ObjectValue> implements Inspector<T> {\n  subtype;\n\n  className;\n\n  toDescription;\n\n  private toEntries;\n\n  private additionalProperties;\n\n  private internalProperties;\n\n  constructor(\n    className: string | ((value: Value) => string),\n    subtype: Protocol.Runtime.RemoteObject['subtype'],\n    toDescription: (value: T) => string,\n    additionalOptions?: {\n      entries?: (value: T) => Protocol.Runtime.ObjectPreview['entries'];\n      additionalProperties?: (value: T) => Iterable<[string, Value]>;\n      internalProperties?: (value: T) => Iterable<[string, Value | MapObject['MapData'] | SetObject['SetData']]>;\n    },\n  ) {\n    this.className = className;\n    this.subtype = subtype;\n    this.toDescription = toDescription;\n    this.toEntries = additionalOptions?.entries;\n    this.additionalProperties = additionalOptions?.additionalProperties;\n    this.internalProperties = additionalOptions?.internalProperties;\n  }\n\n  toRemoteObject(value: T, getObjectId: (val: ObjectValue) => string): Protocol.Runtime.RemoteObject {\n    return {\n      type: 'object',\n      subtype: this.subtype,\n      objectId: getObjectId(value),\n      className: typeof this.className === 'string' ? this.className : this.className(value),\n      description: this.toDescription(value),\n      preview: this.toObjectPreview(value),\n    };\n  }\n\n  toPropertyPreview(name: string, value: T): Protocol.Runtime.PropertyPreview {\n    return {\n      name,\n      type: 'object',\n      subtype: this.subtype,\n      value: this.toDescription(value),\n    };\n  }\n\n  toInternalProperties(value: T, getObjectId: (val: ObjectValue | SymbolValue) => string, generatePreview: boolean | undefined): Protocol.Runtime.InternalPropertyDescriptor[] {\n    const internalProperties = [...this.internalProperties?.(value) || []];\n    if (!internalProperties.length) {\n      return [];\n    }\n    return internalProperties.map(([name, val]): Protocol.Runtime.InternalPropertyDescriptor => {\n      let value: Protocol.Runtime.RemoteObject;\n      if (val instanceof Value) {\n        value = getInspector(val).toRemoteObject(val, getObjectId, generatePreview);\n      } else {\n        const array = new ObjectValue([]);\n        array.DefineOwnProperty = ArrayExoticObjectInternalMethods.DefineOwnProperty;\n        array.properties.set('length', Descriptor({ Value: F(val.length) }));\n        for (const [index, item] of val.entries()) {\n          let value;\n          if (item instanceof Value) {\n            value = item;\n          } else {\n            if (!item?.Key || !item.Value) {\n              continue;\n            }\n            value = new ObjectValue(['InspectorEntry']);\n            value.properties.set('key', Descriptor({ Value: item.Key }));\n            value.properties.set('value', Descriptor({ Value: item.Value }));\n          }\n          array.properties.set(Value(index.toString()), Descriptor({ Value: value }));\n        }\n        value = Array.toRemoteObject(array, getObjectId, generatePreview);\n      }\n      return ({ name, value });\n    });\n  }\n\n  toObjectPreview(value: T): Protocol.Runtime.ObjectPreview {\n    const e = this.toEntries?.(value);\n    return {\n      type: 'object',\n      subtype: this.subtype,\n      description: this.toDescription(value),\n      entries: e?.length ? e : undefined,\n      ...propertiesToPropertyPreview(value, [...this.internalProperties?.(value) || [], ...this.additionalProperties?.(value) || []]),\n    };\n  }\n}\n\nconst InspectorEntry = new ObjectInspector<ObjectValue>('Object', 'internal#entry' as never, (value) => {\n  const key = value.properties.get(Value('key'))!.Value!;\n  const val = value.properties.get(Value('value'))!.Value!;\n  return `{${getInspector(key).toDescription(key)} => ${getInspector(val).toDescription(val)}}`;\n});\n\nconst Default = new ObjectInspector<ObjectValue>('Object', undefined, (object) => {\n  const [ctor] = object.ConstructedBy;\n  if (!ctor) {\n    return 'Object';\n  }\n  return propertyNameToString(ctor.HostInitialName);\n});\n\nconst ArrayBuffer = new ObjectInspector<ArrayBufferObject>('ArrayBuffer', 'arraybuffer', (value) => `ArrayBuffer(${value.ArrayBufferByteLength})`, {});\nconst DataView = new ObjectInspector<DataViewObject>('DataView', 'dataview', (value) => `DataView(${value.ByteLength})`);\nconst Error = new ObjectInspector<ObjectValue>('SyntaxError', 'error', (value) => {\n  let text = '';\n  surroundingAgent.debugger_scopePreview(() => {\n    evalQ((Q) => {\n      if (value instanceof ObjectValue) {\n        const stack = Q(skipDebugger(Get(value, Value('stack'))));\n        if (stack !== Value.undefined) {\n          text += Q(skipDebugger(ToString(stack))).stringValue();\n        }\n      }\n    });\n  });\n  return text;\n});\n\nconst Map = new ObjectInspector<MapObject>('Map', 'map', (value) => `Map(${value.MapData.filter((x) => !!x.Key).length})`, {\n  additionalProperties: (value) => [['size', Value(value.MapData.filter((x) => !!x.Key).length)]],\n  internalProperties: (value) => [['[[Entries]]', value.MapData]],\n  entries: (value) => value.MapData.filter((x) => x.Key).map(({ Key, Value }) => ({\n    key: getInspector(Key!).toObjectPreview(Key!),\n    value: getInspector(Value!).toObjectPreview(Value!),\n  })),\n});\nconst Set = new ObjectInspector<SetObject>('Set', 'set', (value) => `Set(${value.SetData.filter(globalThis.Boolean).length})`, {\n  additionalProperties: (value) => [['size', Value(value.SetData.filter(globalThis.Boolean).length)]],\n  internalProperties: (value) => [['[[Entries]]', value.SetData]],\n  entries: (value) => value.SetData.filter(globalThis.Boolean).map((Value) => ({\n    value: getInspector(Value!).toObjectPreview(Value!),\n  })),\n});\nconst WeakMap = new ObjectInspector<WeakMapObject>('WeakMap', 'weakmap', () => 'WeakMap', {\n  internalProperties: (value) => [['[[Entries]]', value.WeakMapData]],\n  entries: (value) => value.WeakMapData.filter((x) => x.Key).map(({ Key, Value }) => ({\n    key: getInspector(Key!).toObjectPreview(Key!),\n    value: getInspector(Value!).toObjectPreview(Value!),\n  })),\n});\nconst WeakSet = new ObjectInspector<WeakSetObject>('WeakSet', 'weakset', () => 'WeakSet', {\n  internalProperties: (value) => [['[[Entries]]', value.WeakSetData]],\n  entries: (value) => value.WeakSetData.filter(globalThis.Boolean).map((Value) => ({\n    value: getInspector(Value!).toObjectPreview(Value!),\n  })),\n});\n\nconst Date = new ObjectInspector<DateObject>('Date', 'date', ((value: DateObject) => {\n  if (!globalThis.Number.isFinite(R(value.DateValue))) {\n    return 'Invalid Date';\n  }\n  const val = DateProto_toISOString([], { thisValue: value, NewTarget: Value.undefined });\n  return ValueOfNormalCompletion(val as NormalCompletion<JSStringValue>).stringValue();\n}));\nconst Promise = new ObjectInspector<PromiseObject>('Promise', 'promise', () => 'Promise', {\n  internalProperties: (value) => [['[[PromiseState]]', Value(value.PromiseState)], ['[[PromiseResult]]', value.PromiseResult || Value.undefined]],\n});\nconst Proxy = new ObjectInspector<ProxyObject>('Proxy', 'proxy', (value) => {\n  if (IsCallable(value.ProxyTarget)) {\n    return 'Proxy(Function)';\n  }\n  if (value.ProxyTarget instanceof ObjectValue) {\n    return 'Proxy(Object)';\n  }\n  return 'Proxy';\n});\nconst RegExp = new ObjectInspector<RegExpObject>('RegExp', 'regexp', (value) => `/${value.OriginalSource.stringValue()}/${value.OriginalFlags.stringValue()}`);\nconst Module = new ObjectInspector<ModuleNamespaceObject>('Module', undefined, () => 'Module', {});\nconst ShadowRealm = new ObjectInspector<ShadowRealmObject>('ShadowRealm', undefined, () => 'ShadowRealm', {\n  internalProperties: (realm) => [['[[GlobalObject]]', realm.ShadowRealm.GlobalObject]],\n});\n\nconst Array: Inspector<ObjectValue> = {\n  toRemoteObject(value, getObjectId) {\n    return {\n      type: 'object',\n      className: 'Array',\n      subtype: 'array',\n      objectId: getObjectId(value),\n      description: getInspector(value).toDescription(value),\n      preview: this.toObjectPreview?.(value),\n    };\n  },\n  toPropertyPreview(name, value) {\n    return {\n      name, type: 'object', subtype: 'array', value: this.toDescription(value),\n    };\n  },\n  toObjectPreview(value) {\n    const result: Protocol.Runtime.ObjectPreview = {\n      type: 'object',\n      subtype: 'array',\n      overflow: false,\n      properties: [],\n      description: this.toDescription(value),\n    };\n    const indexProp: Protocol.Runtime.PropertyPreview[] = [];\n    const otherProp: Protocol.Runtime.PropertyPreview[] = [];\n    for (const [key, desc] of value.properties) {\n      if (indexProp.length > 100) {\n        result.overflow = true;\n        break;\n      }\n      if (isIntegerIndex(key)) {\n        indexProp.push(propertyToPropertyPreview(key, desc));\n      } else if (!(key instanceof JSStringValue && key.stringValue() === 'length')) {\n        otherProp.push(propertyToPropertyPreview(key, desc));\n      }\n    }\n    result.properties = indexProp.concat(otherProp).slice(0, 100);\n    return result;\n  },\n  toDescription(value) {\n    const length = [...value.properties.entries()].find(([key]) => key instanceof JSStringValue && key.stringValue() === 'length');\n    if (!length || !(length[1].Value instanceof NumberValue)) {\n      throw new TypeError('Bad ArrayExoticObject');\n    }\n    return `Array(${R(length[1].Value)})`;\n  },\n};\nconst TypedArray = new ObjectInspector<TypedArrayObject>('TypedArray', 'typedarray', (value) => `${value.TypedArrayName.stringValue()}(${value.ArrayLength})`);\n\nfunction propertyNameToString(value: PropertyKeyValue | PrivateName): string {\n  if (value instanceof JSStringValue) {\n    return value.stringValue();\n  } else if (value instanceof PrivateName) {\n    return value.Description.stringValue();\n  } else {\n    return SymbolDescriptiveString(value).stringValue();\n  }\n}\nfunction propertyToPropertyPreview(key: PropertyKeyValue | PrivateName, desc: Descriptor | PrivateElementRecord): Protocol.Runtime.PropertyPreview {\n  const name = propertyNameToString(key);\n  if (desc.Get || desc.Set) {\n    return { name, type: 'accessor' };\n  } else {\n    return getInspector(desc.Value!).toPropertyPreview(name, desc.Value!);\n  }\n}\n\nfunction propertiesToPropertyPreview(value: ObjectValue, extra: undefined | Iterable<[string, Value | MapObject['MapData'] | SetObject['SetData']]>, max = 5) {\n  let overflow = false;\n  const properties: Protocol.Runtime.PropertyPreview[] = [];\n  if (extra) {\n    for (const [key, value] of extra) {\n      if (value instanceof Value) {\n        properties.push(getInspector(value).toPropertyPreview(key, value));\n      }\n      // TODO:... handle Value[]\n    }\n  }\n  if (isTypedArrayObject(value) && value.ViewedArrayBuffer instanceof ObjectValue && value.ViewedArrayBuffer.ArrayBufferData instanceof DataBlock) {\n    const record = MakeTypedArrayWithBufferWitnessRecord(value, 'seq-cst');\n    const length = TypedArrayLength(record);\n    for (let index = 0; index < length; index += 1) {\n      const index_value = TypedArrayGetElement(value, Value(index));\n      if (index_value instanceof UndefinedValue) {\n        break;\n      }\n      if (properties.length > 100) {\n        overflow = true;\n        break;\n      }\n      properties.push(getInspector(index_value).toPropertyPreview(index.toString(), index_value));\n    }\n    properties.push(\n      {\n        name: 'buffer', type: 'object', subtype: 'arraybuffer', value: `ArrayBuffer(${value.ViewedArrayBuffer.ArrayBufferData.byteLength})`,\n      },\n      { name: 'byteLength', type: 'number', value: globalThis.String(value.ArrayLength) },\n      { name: 'byteOffset', type: 'number', value: globalThis.String(value.ByteOffset) },\n      { name: 'length', type: 'number', value: globalThis.String(length) },\n    );\n  }\n  for (const [key, desc] of value.properties) {\n    if (properties.length > max) {\n      overflow = true;\n      break;\n    }\n    properties.push(propertyToPropertyPreview(key, desc));\n  }\n  for (const desc of value.PrivateElements) {\n    if (properties.length > max) {\n      overflow = true;\n      break;\n    }\n    properties.push(propertyToPropertyPreview(desc.Key, desc));\n  }\n  return { overflow, properties };\n}\n\nexport function getInspector(value: Value): Inspector<Value> {\n  switch (true) {\n    case value === Value.null:\n      return Null;\n    case value === Value.undefined:\n      return Undefined;\n    case value === Value.true || value === Value.false:\n      return Boolean;\n    case value instanceof SymbolValue:\n      return Symbol;\n    case value instanceof JSStringValue:\n      return String;\n    case value instanceof NumberValue:\n    case value instanceof BigIntValue:\n      return Number;\n    case isProxyExoticObject(value):\n      return Proxy;\n    case IsCallable(value):\n      return Function;\n    case isArrayExoticObject(value):\n      return Array;\n    case isRegExpObject(value):\n      return RegExp;\n    case isDateObject(value):\n      return Date;\n    case isMapObject(value):\n      return Map;\n    case isSetObject(value):\n      return Set;\n    case isWeakMapObject(value):\n      return WeakMap;\n    case isWeakSetObject(value):\n      return WeakSet;\n    // generator\n    case isErrorObject(value):\n      return Error;\n    case isPromiseObject(value):\n      return Promise;\n    case isTypedArrayObject(value):\n      return TypedArray;\n    case isArrayBufferObject(value):\n      return ArrayBuffer;\n    case isDataViewObject(value):\n      return DataView;\n    case isModuleNamespaceObject(value):\n      return Module;\n    case isShadowRealmObject(value):\n      return ShadowRealm;\n    case (value as ObjectValue).internalSlotsList.includes('InspectorEntry'):\n      return InspectorEntry;\n    default:\n      return Default;\n  }\n}\n","import type { Protocol } from 'devtools-protocol';\nimport { getInspector } from './inspect.mts';\nimport type { Inspector } from './index.mts';\nimport {\n  EnsureCompletion, JSStringValue, ManagedRealm, NullValue, ObjectValue, SymbolValue, ThrowCompletion, Value,\n  getHostDefinedErrorStack,\n  type ValueCompletion,\n  getCurrentStack,\n  isECMAScriptFunctionObject,\n  SymbolDescriptiveString,\n  type EnvironmentRecordWithThisBinding,\n  EnvironmentRecord,\n  DeclarativeEnvironmentRecord,\n  ObjectEnvironmentRecord,\n  FunctionEnvironmentRecord,\n  GlobalEnvironmentRecord,\n  ModuleEnvironmentRecord,\n  OrdinaryObjectCreate,\n  Descriptor,\n  isArgumentExoticObject,\n  Agent,\n  surroundingAgent,\n  IsAccessorDescriptor,\n  isIntegerIndex,\n  isBuiltinFunctionObject,\n  isArrayBufferObject,\n  DataBlock,\n  CallSite,\n  CallFrame,\n  type OrdinaryObject,\n} from '#self';\n\ninterface InspectedRealmDescriptor {\n  readonly realm: ManagedRealm;\n  readonly descriptor: Protocol.Runtime.ExecutionContextDescription;\n  readonly agent: Agent;\n  detach(): void;\n}\nexport class InspectorContext {\n  #io: Inspector;\n\n  constructor(io: Inspector) {\n    this.#io = io;\n  }\n\n  realms: (InspectedRealmDescriptor | undefined)[] = [];\n\n  attachRealm(realm: ManagedRealm, agent: Agent) {\n    const id = this.realms.length;\n    const descriptor: Protocol.Runtime.ExecutionContextDescription = {\n      id,\n      origin: realm.HostDefined.specifier || 'vm://repl',\n      name: realm.HostDefined.name || 'engine262',\n      uniqueId: id.toString(),\n    };\n    this.realms.push({\n      realm,\n      descriptor,\n      agent,\n      detach: () => {\n        realm.HostDefined.attachingInspector = oldInspector;\n        realm.HostDefined.attachingInspectorReportError = function attachingInspectorReportError(realm, error) {\n          if (this.attachingInspector && realm instanceof ManagedRealm) {\n            (this.attachingInspector as Inspector).console(realm, 'error' as Protocol.Runtime.ConsoleAPICalledEventType, [error]);\n          }\n        };\n      },\n    });\n    const oldInspector = realm.HostDefined.attachingInspector;\n    realm.HostDefined.attachingInspector = this.#io;\n    const oldPromiseRejectionTracker = realm.HostDefined.promiseRejectionTracker;\n    realm.HostDefined.promiseRejectionTracker = (promise, operation) => {\n      oldPromiseRejectionTracker?.(promise, operation);\n      if (operation === 'reject') {\n        this.#io.sendEvent['Runtime.exceptionThrown']({\n          timestamp: Date.now(),\n          exceptionDetails: this.createExceptionDetails(promise, true),\n        });\n      } else {\n        const id = this.#exceptionMap.get(promise);\n        if (id) {\n          this.#io.sendEvent['Runtime.exceptionRevoked']({\n            reason: 'Handler added to rejected promise',\n            exceptionId: id,\n          });\n        }\n      }\n    };\n    this.#io.sendEvent['Runtime.executionContextCreated']({ context: descriptor });\n  }\n\n  detachAgent(agent: Agent) {\n    for (const realm of this.realms) {\n      if (realm?.agent === agent) {\n        this.detachRealm(realm.realm);\n      }\n    }\n  }\n\n  detachRealm(realm: ManagedRealm) {\n    const index = this.realms.findIndex((c) => c?.realm === realm);\n    if (index === -1) {\n      return;\n    }\n    const { descriptor } = this.realms[index]!;\n    realm.HostDefined.attachingInspector = undefined;\n    realm.HostDefined.attachingInspectorReportError = undefined;\n    this.realms[index] = undefined;\n    this.#io.sendEvent['Runtime.executionContextDestroyed']({ executionContextId: descriptor.id, executionContextUniqueId: descriptor.uniqueId });\n  }\n\n  getRealm(realm: ManagedRealm | string | number | undefined) {\n    if (realm === undefined) {\n      if (surroundingAgent.runningExecutionContext && surroundingAgent.currentRealmRecord instanceof ManagedRealm) {\n        realm = surroundingAgent.currentRealmRecord;\n      } else {\n        return undefined;\n      }\n    }\n    if (typeof realm === 'string') {\n      return this.realms.find((c) => c?.descriptor.uniqueId === realm);\n    } else if (typeof realm === 'number') {\n      return this.realms[realm];\n    }\n    return this.realms.find((c) => c?.realm === realm);\n  }\n\n  /** @deprecated in this case we are guessing the realm should be using, which may create bad result */\n  getAnyRealm() {\n    return this.realms.find(Boolean);\n  }\n\n  #idToObject = new Map<string, ObjectValue | SymbolValue>();\n\n  // id 0 is falsy, skip it\n  #idToArrayBufferBlock: (undefined | ArrayBuffer)[] = [undefined];\n\n  #objectToId = new Map<ObjectValue | SymbolValue, string>();\n\n  #objectCounter = 1;\n\n  #internObject(object: ObjectValue | SymbolValue, group = 'default') {\n    if (this.#objectToId.has(object)) {\n      return this.#objectToId.get(object)!;\n    }\n    const id = `${group}:${this.#objectCounter}`;\n    this.#objectCounter += 1;\n    this.#idToObject.set(id, object);\n    this.#objectToId.set(object, id);\n    return id;\n  }\n\n  releaseObject(id: string) {\n    const object = this.#idToObject.get(id);\n    if (object) {\n      this.#idToObject.delete(id);\n      this.#objectToId.delete(object);\n    }\n  }\n\n  releaseObjectGroup(group: string) {\n    for (const [id, object] of this.#idToObject.entries()) {\n      if (id.startsWith(group)) {\n        this.#idToObject.delete(id);\n        this.#objectToId.delete(object);\n      }\n    }\n  }\n\n  getObject(objectId: string) {\n    return this.#idToObject.get(objectId);\n  }\n\n  toRemoteObject(value: Value, options: { objectGroup?: string, generatePreview?: boolean }): Protocol.Runtime.RemoteObject {\n    return getInspector(value).toRemoteObject(value, (val) => this.#internObject(val, options.objectGroup), options.generatePreview);\n  }\n\n  getProperties({\n    objectId, accessorPropertiesOnly, generatePreview, nonIndexedPropertiesOnly, ownProperties,\n  }: Protocol.Runtime.GetPropertiesRequest): Protocol.Runtime.GetPropertiesResponse {\n    const object = this.getObject(objectId);\n    if (!(object instanceof ObjectValue)) {\n      return { result: [] };\n    }\n    const wrap = (v: Value) => this.toRemoteObject(v, { generatePreview });\n\n    const properties: Protocol.Runtime.PropertyDescriptor[] = [];\n    const internalProperties: Protocol.Runtime.InternalPropertyDescriptor[] = [];\n    const privateProperties: Protocol.Runtime.PrivatePropertyDescriptor[] = [];\n\n    object.PrivateElements.forEach((value) => {\n      privateProperties.push({\n        name: value.Key.Description.stringValue(),\n        value: value.Value ? wrap(value.Value) : undefined,\n        get: value.Get ? wrap(value.Get) : undefined,\n        set: value.Set ? wrap(value.Set) : undefined,\n      });\n    });\n\n    (() => {\n      let p: NullValue | ObjectValue = object;\n      while (p instanceof ObjectValue) {\n        for (const key of p.properties.keys()) {\n          if (nonIndexedPropertiesOnly && isIntegerIndex(key)) {\n            continue;\n          }\n          const desc = (p.properties.get(key));\n          if (!desc) {\n            return;\n          }\n          if (accessorPropertiesOnly && !IsAccessorDescriptor(desc)) {\n            continue;\n          }\n          const descriptor: Protocol.Runtime.PropertyDescriptor = {\n            name: key instanceof JSStringValue\n              ? key.stringValue()\n              : SymbolDescriptiveString(key).stringValue(),\n            value: desc.Value && !('HostUninitializedBindingMarkerObject' in desc.Value) ? wrap(desc.Value) : undefined,\n            writable: desc.Writable === Value.true,\n            get: desc.Get ? wrap(desc.Get) : undefined,\n            set: desc.Set ? wrap(desc.Set) : undefined,\n            configurable: desc.Configurable === Value.true,\n            enumerable: desc.Enumerable === Value.true,\n            wasThrown: false,\n            isOwn: p === object,\n            symbol: key instanceof SymbolValue ? wrap(key) : undefined,\n          };\n          properties.push(descriptor);\n        }\n\n        if (ownProperties) {\n          break;\n        }\n        if ('Prototype' in p) {\n          p = (p as OrdinaryObject).Prototype;\n        } else {\n          p = Value.null;\n        }\n      }\n    })();\n\n    const additionalInternalFields = getInspector(object).toInternalProperties?.(object, (val) => this.#internObject(val, 'default'), generatePreview);\n    if (additionalInternalFields) {\n      internalProperties.push(...additionalInternalFields);\n    }\n\n    if ('Prototype' in object) {\n      internalProperties.push({\n        name: '[[Prototype]]',\n        value: wrap(object.Prototype as Value),\n      });\n    }\n    if (isBuiltinFunctionObject(object) && object.nativeFunction.section) {\n      internalProperties.push({\n        name: '[[Section]]',\n        value: {\n          type: 'string',\n          value: object.nativeFunction.section,\n        },\n      });\n    }\n    if (isArrayBufferObject(object) && object.ArrayBufferData instanceof DataBlock) {\n      internalProperties.push({\n        name: '[[ArrayBufferByteLength]]',\n        value: {\n          type: 'number',\n          value: object.ArrayBufferByteLength,\n        },\n      });\n      this.#idToArrayBufferBlock.push(object.ArrayBufferData.buffer);\n      internalProperties.push({\n        name: '[[ArrayBufferData]]',\n        value: {\n          type: 'number',\n          value: this.#idToArrayBufferBlock.length - 1,\n        },\n      });\n    }\n\n    return { result: properties, internalProperties, privateProperties };\n  }\n\n  #exceptionMap = new WeakMap<Value, number>();\n\n  createExceptionDetails(completion: ThrowCompletion | Value, isPromise: boolean): Protocol.Runtime.ExceptionDetails {\n    const value = completion instanceof ThrowCompletion ? completion.Value : completion;\n    const stack = getHostDefinedErrorStack(value);\n    const frames = InspectorContext.callSiteToCallFrame(stack);\n    const exceptionId = this.#objectCounter;\n    this.#objectCounter += 1;\n    this.#exceptionMap.set(value, exceptionId);\n    return {\n      text: isPromise ? 'Uncaught (in promise)' : 'Uncaught',\n      stackTrace: stack ? { callFrames: frames } : undefined,\n      exception: getInspector(value).toRemoteObject(value, (val) => this.#internObject(val), false),\n      lineNumber: frames[0]?.lineNumber || 0,\n      columnNumber: frames[0]?.columnNumber || 0,\n      exceptionId,\n      scriptId: frames[0]?.scriptId,\n      url: frames[0]?.url,\n    };\n  }\n\n  static callSiteToCallFrame(callSite: readonly (CallSite | CallFrame)[] | undefined): Protocol.Runtime.CallFrame[] {\n    return callSite?.map((call) => call.toCallFrame()!).filter(Boolean) || [];\n  }\n\n  createEvaluationResult(completion: ValueCompletion): Protocol.Runtime.EvaluateResponse {\n    completion = EnsureCompletion(completion);\n    if (!(completion.Value instanceof Value)) {\n      throw new RangeError('Invalid completion value');\n    }\n    return {\n      exceptionDetails: completion instanceof ThrowCompletion ? this.createExceptionDetails(completion, false) : undefined,\n      result: this.toRemoteObject(completion.Value, {}),\n    };\n  }\n\n  getDebuggerCallFrame(): Protocol.Debugger.CallFrame[] {\n    const stacks = getCurrentStack(false);\n    const length = surroundingAgent.executionContextStack.length;\n    return stacks.map((stack, index): Protocol.Debugger.CallFrame => {\n      if (!stack.getScriptId()) {\n        return undefined!;\n      }\n      const scopeChain: Protocol.Debugger.Scope[] = [];\n      let env: EnvironmentRecord | NullValue = stack.context.LexicalEnvironment;\n      while (env instanceof EnvironmentRecord) {\n        const result = getDisplayObjectFromEnvironmentRecord(env);\n        if (result) {\n          scopeChain.push({ type: result.type, object: this.toRemoteObject(result.object, {}) });\n        }\n        env = env.OuterEnv;\n      }\n      return {\n        callFrameId: String(length - index - 1),\n        functionName: stack.getFunctionName() || '<anonymous>',\n        location: {\n          scriptId: stack.getScriptId()!,\n          lineNumber: (stack.lineNumber || 1) - 1,\n          columnNumber: (stack.columnNumber || 1) - 1,\n        },\n        this: this.toRemoteObject(HostGetThisEnvironment(stack.context.LexicalEnvironment), {}),\n        url: stack.getSpecifier() || '',\n        canBeRestarted: false,\n        functionLocation: isECMAScriptFunctionObject(stack.context.Function) ? {\n          lineNumber: (stack.context.Function.ECMAScriptCode?.location.start.line || 1) - 1,\n          columnNumber: (stack.context.Function.ECMAScriptCode?.location.start.column || 1) - 1,\n          scriptId: stack.getScriptId() || '',\n        } : undefined,\n        scopeChain,\n      };\n    }).filter(Boolean);\n  }\n\n  evaluateMode: 'script' | 'module' | 'console' = 'script';\n}\n\nfunction HostGetThisEnvironment(env: EnvironmentRecord | NullValue): Value {\n  while (!(env instanceof NullValue)) {\n    const exists = env.HasThisBinding();\n    if (exists === Value.true) {\n      const value = (env as EnvironmentRecordWithThisBinding).GetThisBinding();\n      if (value instanceof ThrowCompletion) {\n        return Value.undefined;\n      }\n      return value as Value;\n    }\n    const outer = env.OuterEnv;\n    env = outer;\n  }\n  throw new ReferenceError('No this environment found');\n}\n\nfunction getDisplayObjectFromEnvironmentRecord(record: EnvironmentRecord): undefined | { type: Protocol.Debugger.Scope['type'], object: ObjectValue } {\n  if (record instanceof DeclarativeEnvironmentRecord) {\n    const object = OrdinaryObjectCreate(Value.null, ['HostInspectorScopePreview']);\n    for (const [key, binding] of record.bindings) {\n      const value = binding.initialized ? binding.value! : OrdinaryObjectCreate(Value.null, ['HostUninitializedBindingMarkerObject']);\n      if (isArgumentExoticObject(value)) {\n        continue;\n      }\n      object.properties.set(key, Descriptor({\n        Enumerable: isArgumentExoticObject(value) ? Value.false : Value.true,\n        Value: value,\n        Writable: binding.mutable ? Value.true : Value.false,\n      }));\n    }\n    let type: Protocol.Debugger.Scope['type'] = 'block';\n    if (record instanceof FunctionEnvironmentRecord) {\n      type = 'local';\n    } else if (record instanceof ModuleEnvironmentRecord) {\n      type = 'module';\n    }\n    if (type !== 'local' && !object.properties.size) {\n      return undefined;\n    }\n    return { type, object };\n  } else if (record instanceof ObjectEnvironmentRecord) {\n    return { type: record.IsWithEnvironment === Value.true ? 'with' : 'global', object: record.BindingObject };\n  } else if (record instanceof GlobalEnvironmentRecord) {\n    return { type: 'global', object: record.GlobalThisValue };\n  }\n  throw new TypeError('Unknown environment record');\n}\n","import type { Protocol } from 'devtools-protocol';\nimport { DynamicParsedCodeRecord, SourceTextModuleRecord, type ScriptRecord } from '#self';\n\nexport function getParsedEvent(source: ScriptRecord | SourceTextModuleRecord | DynamicParsedCodeRecord, id: string, executionContextId: number): Protocol.Debugger.ScriptParsedEvent {\n  const lines = source.ECMAScriptCode.sourceText.split('\\n');\n  return {\n    isModule: source instanceof SourceTextModuleRecord,\n    scriptId: id,\n    url: source.HostDefined.specifier || `vm:///${id}`,\n    startLine: 0,\n    startColumn: 0,\n    endLine: lines.length,\n    endColumn: lines.pop()!.length,\n    executionContextId,\n    hash: '',\n    buildId: '',\n  };\n}\n","import type { Protocol } from 'devtools-protocol';\nimport type {\n  DebuggerContext,\n  DebuggerNamespace, HeapProfilerNamespace, ProfilerNamespace, RuntimeNamespace,\n  TargetNamespace,\n} from './types.mts';\nimport { getParsedEvent } from './internal-utils.mts';\nimport { InspectorContext } from './context.mts';\nimport {\n  Call, NormalCompletion, ObjectValue, ParseScript, runJobQueue, ScriptRecord, surroundingAgent, ThrowCompletion, skipDebugger, Value, type FunctionObject,\n  ParseModule,\n  SourceTextModuleRecord, performDevtoolsEval,\n  ValueOfNormalCompletion,\n  JSStringValue,\n  evalQ,\n  Assert,\n  kInternal,\n  captureStack,\n} from '#self';\n\nexport const Debugger: DebuggerNamespace = {\n  enable(_req, { onDebuggerAttached }) {\n    onDebuggerAttached();\n    return { debuggerId: 'debugger.0' };\n  },\n  getScriptSource({ scriptId }) {\n    const source = surroundingAgent.parsedSources.get(scriptId);\n    if (!source) {\n      throw new Error('Not found');\n    }\n    return { scriptSource: source.ECMAScriptCode.sourceText };\n  },\n  setAsyncCallStackDepth() { },\n  setBlackboxPatterns() { },\n  setBlackboxExecutionContexts() { },\n\n  // #region breakpoints\n  getPossibleBreakpoints() {\n  // getPossibleBreakpoints({ start, end, restrictToFunction }) {\n    return { locations: [] };\n    // return { locations: getBreakpointCandidates(start, end, restrictToFunction) };\n  },\n  removeBreakpoint({ breakpointId }) {\n    surroundingAgent?.removeBreakpoint(breakpointId);\n  },\n  // setBreakpoint({ location, condition }) { },\n  setBreakpointByUrl(req) {\n    return surroundingAgent?.addBreakpointByUrl(req);\n  },\n  // setBreakpointOnFunctionCall({ objectId, condition }) { },\n  setBreakpointsActive({ active }) {\n    surroundingAgent.breakpointsEnabled = active;\n  },\n  // setInstrumentationBreakpoint({ instrumentation }) { },\n  setPauseOnExceptions({ state }) {\n    if (surroundingAgent) {\n      surroundingAgent.pauseOnExceptions = state === 'none' ? undefined : state;\n    }\n  },\n  // #endregion\n\n  stepInto(_, { sendEvent }) {\n    sendEvent['Debugger.resumed']();\n    surroundingAgent.resumeEvaluate({ pauseAt: 'step-in' });\n  },\n  resume(_, { sendEvent }) {\n    sendEvent['Debugger.resumed']();\n    surroundingAgent.resumeEvaluate();\n  },\n  stepOver(_req, { sendEvent }) {\n    sendEvent['Debugger.resumed']();\n    surroundingAgent.resumeEvaluate({ pauseAt: 'step-over' });\n  },\n  stepOut(_req, { sendEvent }) {\n    sendEvent['Debugger.resumed']();\n    surroundingAgent.resumeEvaluate({ pauseAt: 'step-out' });\n  },\n  evaluateOnCallFrame(req, context) {\n    return evaluate({\n      ...req,\n      uniqueContextId: context.context.getRealm(undefined)!.descriptor.uniqueId,\n      evalMode: context.context.evaluateMode,\n    }, context);\n  },\n  engine262_setEvaluateMode({ mode }, { context }) {\n    if (mode === 'module' || mode === 'script' || mode === 'console') {\n      context.evaluateMode = mode;\n    }\n  },\n  engine262_setFeatures() {\n    throw new Error('Method should not be implemented here.');\n  },\n};\nexport const Profiler: ProfilerNamespace = {\n  enable() { },\n};\nexport const Runtime: RuntimeNamespace = {\n  discardConsoleEntries() { },\n  enable() {},\n  compileScript(options, { context, sendEvent }) {\n    let parsed!: ScriptRecord | SourceTextModuleRecord | ObjectValue[];\n    let realm = context.getRealm(options.executionContextId);\n    if (!realm && !options.persistScript) {\n      realm = context.getAnyRealm();\n    }\n    if (!realm) {\n      return unsupportedError;\n    }\n    realm.realm.scope(() => {\n      if (context.evaluateMode === 'module') {\n        parsed = ParseModule(options.expression, realm.realm, { specifier: options.sourceURL, doNotTrackScriptId: !options.persistScript });\n      } else {\n        parsed = ParseScript(options.expression, realm.realm, { specifier: options.sourceURL, doNotTrackScriptId: !options.persistScript, [kInternal]: { allowAllPrivateNames: true } });\n      }\n    });\n    if (!parsed) {\n      throw new Error('No parsed result');\n    }\n    if (Array.isArray(parsed)) {\n      const e = context.createExceptionDetails(ThrowCompletion(parsed[0]), false);\n      // Note: it has to be this message to trigger devtools' line wrap.\n      e.exception!.description = 'SyntaxError: Unexpected end of input';\n      return { exceptionDetails: e };\n    }\n    if (options.persistScript) {\n      if (realm?.descriptor.id === undefined) {\n        throw new Error('No realm id found');\n      }\n      const event = getParsedEvent(parsed, parsed.HostDefined.scriptId!, realm.descriptor.id);\n      sendEvent['Debugger.scriptParsed'](event);\n      return { scriptId: event.scriptId };\n    }\n    return {};\n  },\n  callFunctionOn(options, { context }): Protocol.Runtime.CallFunctionOnResponse {\n    const realmDesc = context.getRealm(options.uniqueContextId || options.executionContextId) || context.getAnyRealm();\n    if (!realmDesc) {\n      throw new Error('No realm found');\n    }\n    const { Value: F } = realmDesc.realm.evaluateScript(`(${options.functionDeclaration})`, { doNotTrackScriptId: true }) as NormalCompletion<FunctionObject>;\n    const thisValue = options.objectId\n      ? context.getObject(options.objectId)!\n      : Value.undefined;\n    const args = options.arguments?.map((a) => {\n      // TODO: revisit\n      if ('value' in a) {\n        return Value(a.value);\n      }\n      if (a.objectId) {\n        return context.getObject(a.objectId)!;\n      }\n      if ('unserializableValue' in a) {\n        throw new RangeError();\n      }\n      return Value.undefined;\n    });\n    return realmDesc.realm.scope((): Protocol.Runtime.CallFunctionOnResponse => {\n      const completion = evalQ((Q, X): Protocol.Runtime.CallFunctionOnResponse => {\n        const r = Q(skipDebugger(Call(F, thisValue, args || [])));\n        if (options.returnByValue) {\n          const value = X(Call(realmDesc.realm.Intrinsics['%JSON.stringify%'], Value.undefined, [r]));\n          if (value instanceof JSStringValue) {\n            const valueRealized = JSON.parse(value.stringValue());\n            return { result: { type: typeof value, value: valueRealized } };\n          }\n        }\n        return context.createEvaluationResult(r);\n      });\n      if (completion instanceof ThrowCompletion) {\n        return { result: { type: 'undefined' }, exceptionDetails: context.createExceptionDetails(completion, false) };\n      }\n      return completion.Value;\n    });\n  },\n  evaluate(options, context) {\n    return evaluate({\n      ...options,\n      evalMode: context.context.evaluateMode,\n      uniqueContextId: options.uniqueContextId!,\n    }, context);\n  },\n  getExceptionDetails(req, { context }) {\n    const object = context.getObject(req.errorObjectId)!;\n    if (object instanceof ObjectValue) {\n      return {\n        exceptionDetails: context.createExceptionDetails(ThrowCompletion(object), false),\n      };\n    }\n    return {\n      exceptionDetails: {\n        text: 'unsupported', lineNumber: 0, columnNumber: 0, exceptionId: 0,\n      },\n    };\n  },\n  getHeapUsage() {\n    return {\n      usedSize: 0, totalSize: 0, backingStorageSize: 0, embedderHeapUsedSize: 0,\n    };\n  },\n  getIsolateId() {\n    return { id: 'isolate.0' };\n  },\n  getProperties(options, { context }) {\n    return context.getProperties(options);\n  },\n  globalLexicalScopeNames({ executionContextId }, { context }) {\n    const global = context.getRealm(executionContextId)?.realm.GlobalObject;\n    if (!global) {\n      return { names: [] };\n    }\n    const keys = skipDebugger(global.OwnPropertyKeys());\n    if (keys instanceof ThrowCompletion) {\n      return { names: [] };\n    }\n    return { names: ValueOfNormalCompletion(keys).map((k) => (k instanceof JSStringValue ? k.stringValue() : null!)).filter(Boolean) };\n  },\n  releaseObject(req, { context }) {\n    context.releaseObject(req.objectId);\n  },\n  releaseObjectGroup({ objectGroup }, { context }) {\n    context.releaseObjectGroup(objectGroup);\n  },\n  runIfWaitingForDebugger() { },\n};\nexport const HeapProfiler: HeapProfilerNamespace = {\n  enable() { },\n  collectGarbage() { },\n};\n\nexport const Target: TargetNamespace = {\n  setDiscoverTargets() { },\n  // @ts-expect-error no doc\n  setRemoteLocations() { },\n};\n\nconst unsupportedError: Protocol.Runtime.EvaluateResponse = {\n  result: { type: 'undefined' },\n  exceptionDetails: {\n    text: 'unsupported', lineNumber: 0, columnNumber: 0, exceptionId: 0,\n  },\n};\nfunction evaluate(options: {\n  uniqueContextId: string,\n  expression: string,\n  evalMode: InspectorContext['evaluateMode'],\n  throwOnSideEffect?: boolean,\n  awaitPromise?: boolean,\n  callFrameId?: string,\n}, _context: DebuggerContext): Protocol.Runtime.EvaluateResponse | Promise<Protocol.Runtime.EvaluateResponse> {\n  const { context } = _context;\n  const isPreview = options.throwOnSideEffect;\n  if (options.awaitPromise) {\n    return unsupportedError;\n  }\n  const realm = context.getRealm(options.uniqueContextId);\n  if (!realm) {\n    return unsupportedError;\n  }\n\n  const isCallOnFrame = typeof options.callFrameId === 'string';\n  let callOnFramePoppedLevel = 0;\n  const oldExecutionStack = [...surroundingAgent.executionContextStack];\n  if (isCallOnFrame) {\n    const frame = surroundingAgent.executionContextStack[options.callFrameId as `${number}`];\n    if (!frame) {\n      // eslint-disable-next-line no-console\n      console.error('Execution context not found: ', options.callFrameId);\n      return unsupportedError;\n    }\n    for (const currentFrame of [...surroundingAgent.executionContextStack].reverse()) {\n      if (currentFrame === frame) {\n        break;\n      }\n      callOnFramePoppedLevel += 1;\n      surroundingAgent.executionContextStack.pop(currentFrame);\n    }\n  }\n  const promise = new Promise<Protocol.Runtime.EvaluateResponse>((resolve) => {\n    let toBeEvaluated;\n    if (isPreview || options.evalMode === 'console' || isCallOnFrame) {\n      toBeEvaluated = performDevtoolsEval(options.expression, realm.realm, false, !!(isPreview || isCallOnFrame));\n    } else {\n      let parsed!: ScriptRecord | SourceTextModuleRecord | ObjectValue[];\n      const realm = context.getRealm(options.uniqueContextId);\n      realm?.realm.scope(() => {\n        if (options.evalMode === 'module') {\n          parsed = ParseModule(options.expression, realm.realm);\n        } else {\n          parsed = ParseScript(options.expression, realm.realm);\n        }\n      });\n      if (Array.isArray(parsed)) {\n        const e = context.createExceptionDetails(ThrowCompletion(parsed[0]), false);\n        resolve({ exceptionDetails: e, result: { type: 'undefined' } });\n        return;\n      }\n      toBeEvaluated = parsed;\n    }\n\n    const noDebuggerEvaluate = () => {\n      if (!('next' in toBeEvaluated)) {\n        throw new Assert.Error('Unexpected');\n      }\n      resolve(context.createEvaluationResult(skipDebugger(toBeEvaluated)));\n    };\n    if (isPreview) {\n      surroundingAgent.debugger_scopePreview(noDebuggerEvaluate);\n      return;\n    }\n    if (isCallOnFrame) {\n      noDebuggerEvaluate();\n      return;\n    }\n\n    const completion = realm.realm.evaluate(toBeEvaluated, (completion) => {\n      resolve(context.createEvaluationResult(completion));\n      runJobQueue();\n    });\n    if (completion) {\n      return;\n    }\n    surroundingAgent.resumeEvaluate();\n  });\n  promise.then(() => {\n    if (callOnFramePoppedLevel) {\n      Assert(oldExecutionStack.length - callOnFramePoppedLevel === surroundingAgent.executionContextStack.length);\n      for (const [newIndex, newStack] of surroundingAgent.executionContextStack.entries()) {\n        Assert(newStack === oldExecutionStack[newIndex]);\n      }\n      surroundingAgent.executionContextStack.length = 0;\n      for (const stack of oldExecutionStack) {\n        surroundingAgent.executionContextStack.push(stack);\n      }\n    }\n  }, (err): Protocol.Runtime.EvaluateResponse => {\n    const expr = surroundingAgent.runningExecutionContext.callSite.lastNode?.sourceText;\n    const frame = InspectorContext.callSiteToCallFrame(captureStack().stack);\n    _context.sendEvent['Runtime.exceptionThrown']({\n      timestamp: Date.now(),\n      exceptionDetails: {\n        stackTrace: frame.length ? { callFrames: frame } : undefined,\n        text: `engine262 error when evaluating the following node:\\n\\n    ${expr}\\n\\n${err.constructor.name}: ${err.message}\\n${err.stack.slice(err.stack.indexOf(err.message) + err.message.length + 1)}\\n\\nFrom now on, the engine262 VM state is broken, please press the reload button.`,\n        columnNumber: frame[0]?.columnNumber,\n        lineNumber: frame[0]?.lineNumber,\n        scriptId: frame[0]?.scriptId,\n        url: frame[0]?.url,\n        exceptionId: 0,\n      },\n    });\n    return {\n      result: { type: 'undefined' },\n    };\n  });\n  return promise;\n}\n","import type Protocol from 'devtools-protocol';\nimport type { Inspector } from './index.mts';\nimport {\n  CreateBuiltinFunction, CreateDataProperty, DefinePropertyOrThrow, Descriptor, OrdinaryObjectCreate, surroundingAgent, ThrowCompletion, skipDebugger, Value, type Arguments, type ManagedRealm,\n  type PlainEvaluator,\n  type PlainCompletion,\n} from '#self';\n\nconst consoleMethods = [\n  'log',\n  'debug',\n  'info',\n  'error',\n  'warning',\n  'dir',\n  'dirxml',\n  'table',\n  'trace',\n  'clear',\n  'startGroup',\n  'startGroupCollapsed',\n  'endGroup',\n  'assert',\n  'profile',\n  'profileEnd',\n  'count',\n  'timeEnd',\n] as const;\ntype ConsoleMethod = typeof consoleMethods[number];\nexport function createConsole(\n  realm: ManagedRealm,\n  defaultBehaviour: Partial<Record<ConsoleMethod, (args: Arguments) => void | PlainCompletion<void> | PlainEvaluator<void>>> & { default?: (method: ConsoleMethod, args: Arguments) => void | PlainCompletion<void> | PlainEvaluator<void> },\n) {\n  realm.scope(() => {\n    const console = OrdinaryObjectCreate(realm.Intrinsics['%Object.prototype%']);\n    skipDebugger(DefinePropertyOrThrow(\n      realm.GlobalObject,\n      Value('console'),\n      Descriptor({\n        Configurable: Value.true,\n        Enumerable: Value.false,\n        Writable: Value.true,\n        Value: console,\n      }),\n    ));\n    consoleMethods.forEach((method) => {\n      const f = CreateBuiltinFunction(\n        function* Console(args): PlainEvaluator<Value> {\n          if (surroundingAgent.debugger_isPreviewing) {\n            return Value.undefined;\n          }\n\n          let completion;\n          if (defaultBehaviour[method]) {\n            completion = defaultBehaviour[method](args);\n          } else if (defaultBehaviour.default) {\n            completion = defaultBehaviour.default(method, args);\n          }\n\n          if (completion) {\n            if (typeof completion === 'object' && 'next' in completion) {\n              completion = yield* completion;\n            }\n            // Do not use Q(host) here. A host may return something invalid like ReturnCompletion.\n            if (completion instanceof ThrowCompletion) {\n              return completion;\n            }\n          }\n          if (realm.HostDefined.attachingInspector) {\n            (realm.HostDefined.attachingInspector as Inspector).console(realm, method as Protocol.Protocol.Runtime.ConsoleAPICalledEventType, args);\n          }\n          return Value.undefined;\n        },\n        1,\n        Value(method),\n        [],\n      );\n      skipDebugger(CreateDataProperty(console, Value(method), f));\n    });\n  });\n}\n","import type { Protocol } from 'devtools-protocol';\nimport { InspectorContext } from './context.mts';\nimport * as impl from './methods.mts';\nimport type { DebuggerContext, DebuggerPreference, DevtoolEvents } from './types.mts';\nimport { getParsedEvent } from './internal-utils.mts';\nimport {\n  Agent, ManagedRealm, Realm, type Arguments,\n} from '#self';\n\nconst ignoreNamespaces = ['Network'];\nconst ignoreMethods: string[] = [];\n\nexport type { DebuggerPreference } from './types.mts';\nexport { createConsole } from './utils.mts';\n\ninterface AgentRecord {\n  readonly agent: Agent;\n  onDetach(): void;\n}\nexport abstract class Inspector {\n  #context = new InspectorContext(this);\n\n  #agents: AgentRecord[] = [];\n\n  attachAgent(agent: Agent, priorRealms: ManagedRealm[]) {\n    const oldOnDebugger = agent.hostDefinedOptions.onDebugger;\n    agent.hostDefinedOptions.onDebugger = () => {\n      oldOnDebugger?.();\n      this.sendEvent['Debugger.paused']({\n        reason: 'debugCommand',\n        callFrames: this.#context.getDebuggerCallFrame(),\n      });\n    };\n\n    const oldOnRealmCreated = agent.hostDefinedOptions.onRealmCreated;\n    agent.hostDefinedOptions.onRealmCreated = (realm) => {\n      oldOnRealmCreated?.(realm);\n      this.#context.attachRealm(realm, agent);\n    };\n\n    const oldOnScriptParsed = agent.hostDefinedOptions.onScriptParsed;\n    agent.hostDefinedOptions.onScriptParsed = (script, id) => {\n      oldOnScriptParsed?.(script, id);\n      const realmId = this.#context.getRealm(script.Realm as ManagedRealm)?.descriptor.id;\n      if (realmId === undefined) {\n        return;\n      }\n      this.sendEvent['Debugger.scriptParsed'](getParsedEvent(script, id, realmId));\n    };\n    this.#agents.push({\n      agent,\n      onDetach: () => {\n        agent.hostDefinedOptions.onDebugger = oldOnDebugger;\n        agent.hostDefinedOptions.onRealmCreated = oldOnRealmCreated;\n        agent.hostDefinedOptions.onScriptParsed = oldOnScriptParsed;\n        this.#agents = this.#agents.filter((x) => x.agent !== agent);\n      },\n    });\n    priorRealms.forEach((realm) => {\n      this.#context.attachRealm(realm, agent);\n    });\n  }\n\n  detachAgent(agent: Agent) {\n    const record = this.#agents.find((x) => x.agent === agent);\n    record?.onDetach();\n    this.#context.detachAgent(agent);\n  }\n\n  protected abstract send(data: object): void;\n\n  readonly preference: DebuggerPreference = { previewDebug: false };\n\n  protected onMessage(id: unknown, methodArg: string, params: unknown): void {\n    if (ignoreMethods.includes(methodArg)) {\n      return;\n    }\n    const [namespace, method] = methodArg.split('.');\n    if (ignoreNamespaces.includes(namespace)) {\n      return;\n    }\n    if (!(namespace in impl)) {\n      // eslint-disable-next-line no-console\n      console.error(`Unknown namespace requested: ${namespace}`);\n      return;\n    }\n    const ns = (impl as Record<string, object>)[namespace];\n    if (!(method in ns)) {\n      // eslint-disable-next-line no-console\n      console.error(`Unknown method requested: ${namespace}.${method}`);\n      return;\n    }\n\n    const f = (ns as Record<string, (args: unknown, context: DebuggerContext) => unknown>)[method];\n    new Promise((resolve) => {\n      resolve(f(params, this.#debugContext));\n    }).then((result = {}) => {\n      this.send({ id, result });\n    });\n  }\n\n  sendEvent: DevtoolEvents = Object.create(new Proxy({}, {\n    get: (_, key: string) => {\n      const f = (params: Record<string, unknown>) => {\n        this.send({ method: key, params });\n      };\n      Object.defineProperty(this.sendEvent, key, { value: f });\n      return f;\n    },\n  }));\n\n  console(realm: Realm, type: Protocol.Runtime.ConsoleAPICalledEventType, args: Arguments) {\n    const context = this.#context.getRealm(realm as ManagedRealm);\n    if (!context) {\n      return;\n    }\n    this.sendEvent['Runtime.consoleAPICalled']({\n      type,\n      args: args.map((x) => this.#context.toRemoteObject(x, { })),\n      executionContextId: context.descriptor.id,\n      timestamp: Date.now(),\n    });\n  }\n\n  #debugContext: DebuggerContext = {\n    sendEvent: this.sendEvent,\n    preference: this.preference,\n    context: this.#context,\n    onDebuggerAttached: () => {\n      this.#context.realms.forEach((realm) => {\n        if (realm) {\n          this.sendEvent['Runtime.executionContextCreated']({\n            context: realm.descriptor,\n          });\n        }\n      });\n    },\n  };\n}\n"],"names":["Null","toRemoteObject","type","subtype","value","toObjectPreview","properties","overflow","toPropertyPreview","name","toDescription","Undefined","Boolean","booleanValue","toString","description","Symbol","getObjectId","SymbolDescriptiveString","stringValue","objectId","String","Number","v","R","isNeg0","Object","is","globalThis","isFinite","unserializableValue","r","BigIntValue","unwrapFunction","isWrappedFunctionExoticObject","WrappedTargetFunction","Function","result","IntrinsicsFunctionToString","isECMAScriptFunctionObject","ECMAScriptCode","className","ObjectInspector","toEntries","additionalProperties","internalProperties","constructor","additionalOptions","entries","preview","toInternalProperties","generatePreview","length","map","val","Value","getInspector","array","ObjectValue","DefineOwnProperty","ArrayExoticObjectInternalMethods","set","Descriptor","F","index","item","Key","Array","e","undefined","propertiesToPropertyPreview","InspectorEntry","key","get","Default","object","ctor","ConstructedBy","propertyNameToString","HostInitialName","ArrayBuffer","ArrayBufferByteLength","DataView","ByteLength","Error","text","surroundingAgent","debugger_scopePreview","evalQ","Q","stack","skipDebugger","Get","ToString","Map","MapData","filter","x","Set","SetData","WeakMap","WeakMapData","WeakSet","WeakSetData","Date","DateValue","DateProto_toISOString","thisValue","NewTarget","ValueOfNormalCompletion","Promise","PromiseState","PromiseResult","Proxy","IsCallable","ProxyTarget","RegExp","OriginalSource","OriginalFlags","Module","ShadowRealm","realm","GlobalObject","indexProp","otherProp","desc","isIntegerIndex","push","propertyToPropertyPreview","JSStringValue","concat","slice","find","NumberValue","TypeError","TypedArray","TypedArrayName","ArrayLength","PrivateName","Description","extra","max","isTypedArrayObject","ViewedArrayBuffer","ArrayBufferData","DataBlock","record","MakeTypedArrayWithBufferWitnessRecord","TypedArrayLength","index_value","TypedArrayGetElement","UndefinedValue","byteLength","ByteOffset","PrivateElements","null","true","false","SymbolValue","isProxyExoticObject","isArrayExoticObject","isRegExpObject","isDateObject","isMapObject","isSetObject","isWeakMapObject","isWeakSetObject","isErrorObject","isPromiseObject","isArrayBufferObject","isDataViewObject","isModuleNamespaceObject","isShadowRealmObject","internalSlotsList","includes","InspectorContext","io","realms","attachRealm","agent","id","descriptor","origin","HostDefined","specifier","uniqueId","detach","attachingInspector","oldInspector","attachingInspectorReportError","error","ManagedRealm","console","oldPromiseRejectionTracker","promiseRejectionTracker","promise","operation","sendEvent","timestamp","now","exceptionDetails","createExceptionDetails","reason","exceptionId","context","detachAgent","detachRealm","findIndex","c","executionContextId","executionContextUniqueId","getRealm","runningExecutionContext","currentRealmRecord","getAnyRealm","#internObject","group","has","releaseObject","delete","releaseObjectGroup","startsWith","getObject","options","objectGroup","getProperties","accessorPropertiesOnly","nonIndexedPropertiesOnly","ownProperties","wrap","privateProperties","forEach","p","keys","IsAccessorDescriptor","writable","Writable","configurable","Configurable","enumerable","Enumerable","wasThrown","isOwn","symbol","Prototype","additionalInternalFields","isBuiltinFunctionObject","nativeFunction","section","buffer","completion","isPromise","ThrowCompletion","getHostDefinedErrorStack","frames","callSiteToCallFrame","stackTrace","callFrames","exception","lineNumber","columnNumber","scriptId","url","callSite","call","toCallFrame","createEvaluationResult","EnsureCompletion","RangeError","getDebuggerCallFrame","stacks","getCurrentStack","executionContextStack","getScriptId","scopeChain","env","LexicalEnvironment","EnvironmentRecord","getDisplayObjectFromEnvironmentRecord","OuterEnv","callFrameId","functionName","getFunctionName","location","this","HostGetThisEnvironment","getSpecifier","canBeRestarted","functionLocation","start","line","column","evaluateMode","NullValue","exists","HasThisBinding","GetThisBinding","outer","ReferenceError","DeclarativeEnvironmentRecord","OrdinaryObjectCreate","binding","bindings","initialized","isArgumentExoticObject","mutable","FunctionEnvironmentRecord","ModuleEnvironmentRecord","size","ObjectEnvironmentRecord","IsWithEnvironment","BindingObject","GlobalEnvironmentRecord","GlobalThisValue","getParsedEvent","source","lines","sourceText","split","isModule","SourceTextModuleRecord","startLine","startColumn","endLine","endColumn","pop","hash","buildId","Debugger","enable","_req","onDebuggerAttached","debuggerId","getScriptSource","parsedSources","scriptSource","setAsyncCallStackDepth","setBlackboxPatterns","setBlackboxExecutionContexts","getPossibleBreakpoints","locations","removeBreakpoint","breakpointId","setBreakpointByUrl","req","addBreakpointByUrl","setBreakpointsActive","active","breakpointsEnabled","setPauseOnExceptions","state","pauseOnExceptions","stepInto","_","resumeEvaluate","pauseAt","resume","stepOver","stepOut","evaluateOnCallFrame","evaluate","uniqueContextId","evalMode","engine262_setEvaluateMode","mode","engine262_setFeatures","Profiler","Runtime","discardConsoleEntries","compileScript","parsed","persistScript","unsupportedError","scope","ParseModule","expression","sourceURL","doNotTrackScriptId","ParseScript","kInternal","allowAllPrivateNames","isArray","event","callFunctionOn","realmDesc","evaluateScript","functionDeclaration","args","arguments","a","X","Call","returnByValue","Intrinsics","valueRealized","JSON","parse","getExceptionDetails","errorObjectId","getHeapUsage","usedSize","totalSize","backingStorageSize","embedderHeapUsedSize","getIsolateId","globalLexicalScopeNames","global","names","OwnPropertyKeys","k","runIfWaitingForDebugger","HeapProfiler","collectGarbage","Target","setDiscoverTargets","setRemoteLocations","_context","isPreview","throwOnSideEffect","awaitPromise","isCallOnFrame","callOnFramePoppedLevel","oldExecutionStack","frame","currentFrame","reverse","resolve","toBeEvaluated","performDevtoolsEval","noDebuggerEvaluate","Assert","runJobQueue","then","newIndex","newStack","err","expr","lastNode","captureStack","message","indexOf","consoleMethods","createConsole","defaultBehaviour","DefinePropertyOrThrow","method","f","CreateBuiltinFunction","Console","debugger_isPreviewing","default","CreateDataProperty","ignoreNamespaces","ignoreMethods","Inspector","attachAgent","priorRealms","oldOnDebugger","hostDefinedOptions","onDebugger","oldOnRealmCreated","onRealmCreated","oldOnScriptParsed","onScriptParsed","script","realmId","Realm","onDetach","preference","previewDebug","onMessage","methodArg","params","namespace","impl","ns","send","create","defineProperty"],"mappings":"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"}