{"version":3,"file":"inspector.mjs","sources":["../lib-src/inspector/inspect.mts","../lib-src/inspector/context.mts","../lib-src/inspector/internal-utils.mts","../lib-src/inspector/methods.mts","../lib-src/inspector/utils.mts","../lib-src/inspector/index.mts"],"sourcesContent":["import type { Protocol } from 'devtools-protocol';\nimport {\n  BigIntValue,\n  Descriptor,\n  evalQ,\n  Get,\n  IntrinsicsFunctionToString, isArrayBufferObject, isArrayExoticObject, IsCallable, isDataViewObject, isDateObject, isECMAScriptFunctionObject, isErrorObject, isIntegerIndex, isMapObject, isPromiseObject, isProxyExoticObject, isRegExpObject, isSetObject, isTypedArrayObject, isWeakMapObject, isWeakSetObject, JSStringValue, NumberValue, ObjectValue, PrivateElementRecord, PrivateName, R, surroundingAgent, SymbolDescriptiveString, SymbolValue, ToString, skipDebugger, UndefinedValue, Value, type ArrayBufferObject, type BooleanValue, type DataViewObject, type DateObject, type FunctionObject, type MapObject, type NullValue, type PromiseObject, type PropertyKeyValue, type ProxyObject, type RegExpObject, type SetObject, type TypedArrayObject,\n  type WeakMapObject,\n  type WeakSetObject,\n  type ModuleNamespaceObject,\n  isModuleNamespaceObject,\n  DataBlock,\n  TypedArrayGetElement,\n  TypedArrayLength,\n  MakeTypedArrayWithBufferWitnessRecord,\n  DateProto_toISOString,\n  ValueOfNormalCompletion,\n  NormalCompletion,\n} from '#self';\n\n/*\nTest code: copy this into the inspector console.\nprimitive: console.log('primitive:', null, undefined, true, false, 0, -0, NaN, Infinity, -Infinity, 1n, 'string', Symbol(), Symbol('text'), Symbol.for('global'), Symbol.iterator);\nfn: console.log('builtin:', eval, '\\nfunction:', function() { code }, '\\ngenerator:', function*() { code }, '\\nasync:', async function() { code }, '\\nasync generator:', async function*() { code }, '\\narrow:', () => { code }, '\\narrow async:', async () => { code });\n\nnormal: console.log('normal:', {}, new (class T { #a }), globalThis);\narraybuffer: console.log('arraybuffer:', new ArrayBuffer(8));\ndataview: console.log('dataview:', new DataView(new ArrayBuffer(8)));\nmap: console.log('map:', new Map(), new Map([[eval, globalThis], [1, 2]]));\nset: console.log('set:', new Set(), new Set([1, globalThis]));\nweakmap: console.log('weakmap:', new WeakMap(), new WeakMap([[{}, 1]]));\nweakset: console.log('weakset:', new WeakSet(), new WeakSet([{}]));\ndate: console.log('date:', new Date());\npromise: console.log('promise:', new Promise(() => {}), Promise.resolve(globalThis), Promise.reject(globalThis));\nproxy: {  const x = Proxy.revocable({}, {}); x.revoke(); console.log('proxy:', new Proxy({}, {}), new Proxy(function() {}, {}), x.proxy); }\nregexp: console.log('regexp:', /pattern/, new RegExp('pattern', 'g'));\narray: console.log('array:', [], [1, 2], Object.assign([1, 2], { a: 1 }), [0, ,,, 3]);\ntypedarray: console.log('typedarray:', new Int8Array(8), new Int16Array(8), new Int32Array(8), new Uint8Array(8), new Uint16Array(8), new Uint32Array(8), new Uint8ClampedArray(8), new Float32Array(8), new Float64Array(8), new BigInt64Array(8), new BigUint64Array(8));\n*/\ninterface Inspector<T extends Value> {\n    toRemoteObject(value: T, getObjectId: (val: SymbolValue | ObjectValue) => string, generatePreview: boolean | undefined): Protocol.Runtime.RemoteObject;\n    toObjectPreview(value: T): Protocol.Runtime.ObjectPreview;\n    toPropertyPreview(name: string, value: T): Protocol.Runtime.PropertyPreview;\n    toDescription(value: T): string;\n}\n\nconst Null: Inspector<NullValue> = {\n  toRemoteObject: () => ({ type: 'object', subtype: 'null', value: null }),\n  toObjectPreview: () => ({\n    type: 'object', subtype: 'null', properties: [], overflow: false,\n  }),\n  toPropertyPreview: (name) => ({\n    name, type: 'object', subtype: 'null', value: 'null',\n  }),\n  toDescription: () => '',\n};\n\nconst Undefined: Inspector<UndefinedValue> = {\n  toRemoteObject: () => ({ type: 'undefined' }),\n  toObjectPreview: () => ({\n    type: 'undefined', properties: [], overflow: false,\n  }),\n  toPropertyPreview: (name) => ({\n    name, type: 'undefined', value: 'undefined',\n  }),\n  toDescription: () => 'undefined',\n};\n\nconst Boolean: Inspector<BooleanValue> = {\n  toRemoteObject: (value) => ({ type: 'boolean', value: value.booleanValue() }),\n  toPropertyPreview: (name, value) => ({\n    name, type: 'boolean', value: value.booleanValue().toString(),\n  }),\n  toObjectPreview(value) {\n    return {\n      type: 'boolean',\n      value: value.booleanValue(),\n      description: value.booleanValue().toString(),\n      overflow: false,\n      properties: [],\n    };\n  },\n  toDescription: (value) => value.booleanValue().toString(),\n};\n\nconst Symbol: Inspector<SymbolValue> = {\n  toRemoteObject: (value, getObjectId) => ({\n    type: 'symbol',\n    description: SymbolDescriptiveString(value).stringValue(),\n    objectId: getObjectId(value),\n  }),\n  toPropertyPreview: (name, value) => ({\n    name, type: 'symbol', value: SymbolDescriptiveString(value).stringValue(),\n  }),\n  toObjectPreview: (value) => ({\n    type: 'symbol',\n    description: SymbolDescriptiveString(value).stringValue(),\n    overflow: false,\n    properties: [],\n  }),\n  toDescription: (value) => SymbolDescriptiveString(value).stringValue(),\n};\n\nconst String: Inspector<JSStringValue> = {\n  toRemoteObject: (value) => ({ type: 'string', value: value.stringValue() }),\n  toPropertyPreview(name, value) {\n    return {\n      name, type: 'string', value: value.stringValue(),\n    };\n  },\n  toObjectPreview(value) {\n    return {\n      type: 'string',\n      description: value.stringValue(),\n      overflow: false,\n      properties: [],\n    };\n  },\n  toDescription: (value) => value.stringValue(),\n};\n\nconst Number: Inspector<NumberValue> = {\n  toRemoteObject(value) {\n    const v = R(value);\n    let description = v.toString();\n    const isNeg0 = Object.is(v, -0);\n    // Includes values `-0`, `NaN`, `Infinity`, `-Infinity`, and bigint literals.\n    if (isNeg0 || !globalThis.Number.isFinite(v)) {\n      if (typeof v === 'bigint') {\n        description += 'n';\n        return { type: 'bigint', unserializableValue: description, description };\n      }\n      return { type: 'number', unserializableValue: description, description: isNeg0 ? '-0' : description };\n    }\n    return { type: 'number', value: v, description };\n  },\n  toPropertyPreview(name, value) {\n    return {\n      name, type: 'number', value: this.toDescription(value),\n    };\n  },\n  toObjectPreview(value) {\n    return {\n      type: 'number',\n      description: this.toDescription(value),\n      overflow: false,\n      properties: [],\n    };\n  },\n  toDescription: (value) => {\n    const r = R(value);\n    return value instanceof BigIntValue ? `${r}n` : r.toString();\n  },\n};\n\nconst Function: Inspector<FunctionObject> = {\n  toRemoteObject(value, getObjectId) {\n    const result: Protocol.Runtime.RemoteObject = {\n      type: 'function',\n      objectId: getObjectId(value),\n    };\n    result.description = IntrinsicsFunctionToString(value);\n    if (isECMAScriptFunctionObject(value) && value.ECMAScriptCode) {\n      if (value.ECMAScriptCode.type === 'FunctionBody') {\n        result.className = 'Function';\n      } else if (value.ECMAScriptCode.type === 'GeneratorBody') {\n        result.className = 'GeneratorFunction';\n      } else if (value.ECMAScriptCode.type === 'AsyncBody') {\n        result.className = 'AsyncFunction';\n      } else if (value.ECMAScriptCode.type === 'AsyncGeneratorBody') {\n        result.className = 'AsyncGeneratorFunction';\n      }\n    } else {\n      result.className = 'Function';\n    }\n    return result;\n  },\n  toPropertyPreview: (name) => ({ name, type: 'function', value: '' }),\n  toObjectPreview(value) {\n    return {\n      type: 'function',\n      description: IntrinsicsFunctionToString(value),\n      overflow: false,\n      properties: [],\n    };\n  },\n  toDescription: () => 'Function',\n};\n\nclass ObjectInspector<T extends ObjectValue> implements Inspector<T> {\n  subtype;\n\n  className;\n\n  toDescription;\n\n  private toEntries;\n\n  private additionalProperties;\n\n  constructor(\n    className: string | ((value: Value) => string),\n    subtype: Protocol.Runtime.RemoteObject['subtype'],\n    toDescription: (value: T) => string,\n    additionalOptions?: {\n      entries?: (value: T) => Protocol.Runtime.ObjectPreview['entries'];\n      additionalProperties?: (value: T) => Iterable<[string, Value]>;\n    },\n  ) {\n    this.className = className;\n    this.subtype = subtype;\n    this.toDescription = toDescription;\n    this.toEntries = additionalOptions?.entries;\n    this.additionalProperties = additionalOptions?.additionalProperties;\n  }\n\n  toRemoteObject(value: T, getObjectId: (val: ObjectValue) => string): Protocol.Runtime.RemoteObject {\n    return {\n      type: 'object',\n      subtype: this.subtype,\n      objectId: getObjectId(value),\n      className: typeof this.className === 'string' ? this.className : this.className(value),\n      description: this.toDescription(value),\n      preview: this.toObjectPreview(value),\n    };\n  }\n\n  toPropertyPreview(name: string, value: T): Protocol.Runtime.PropertyPreview {\n    return {\n      name, type: 'object', subtype: this.subtype, value: this.toDescription(value),\n    };\n  }\n\n  toObjectPreview(value: T): Protocol.Runtime.ObjectPreview {\n    const e = this.toEntries?.(value);\n    return {\n      type: 'object',\n      subtype: this.subtype,\n      description: this.toDescription(value),\n      entries: e?.length ? e : undefined,\n      ...propertiesToPropertyPreview(value, this.additionalProperties?.(value)),\n    };\n  }\n}\nconst Default = new ObjectInspector<ObjectValue>('Object', undefined, () => 'Object');\n\nconst ArrayBuffer = new ObjectInspector<ArrayBufferObject>('ArrayBuffer', 'arraybuffer', (value) => `ArrayBuffer(${value.ArrayBufferByteLength})`, {});\nconst DataView = new ObjectInspector<DataViewObject>('DataView', 'dataview', (value) => `DataView(${value.ByteLength})`);\nconst Error = new ObjectInspector<ObjectValue>('SyntaxError', 'error', (value) => {\n  let text = '';\n  surroundingAgent.debugger_scopePreview(() => {\n    evalQ((Q) => {\n      if (value instanceof ObjectValue) {\n        const stack = Q(skipDebugger(Get(value, Value('stack'))));\n        if (stack !== Value.undefined) {\n          text += Q(skipDebugger(ToString(stack))).stringValue();\n        }\n      }\n    });\n  });\n  return text;\n});\n\nconst Map = new ObjectInspector<MapObject>('Map', 'map', (value) => `Map(${value.MapData.filter((x) => !!x.Key).length})`, {\n  additionalProperties: (value) => [['size', Value(value.MapData.filter((x) => !!x.Key).length)]],\n  entries: (value) => value.MapData.filter((x) => x.Key).map(({ Key, Value }) => ({\n    key: getInspector(Key!).toObjectPreview(Key!),\n    value: getInspector(Value!).toObjectPreview(Value!),\n  })),\n});\nconst Set = new ObjectInspector<SetObject>('Set', 'set', (value) => `Set(${value.SetData.filter(globalThis.Boolean).length})`, {\n  additionalProperties: (value) => [['size', Value(value.SetData.filter(globalThis.Boolean).length)]],\n  entries: (value) => value.SetData.filter(globalThis.Boolean).map((Value) => ({\n    value: getInspector(Value!).toObjectPreview(Value!),\n  })),\n});\nconst WeakMap = new ObjectInspector<WeakMapObject>('WeakMap', 'weakmap', () => 'WeakMap', {\n  entries: (value) => value.WeakMapData.filter((x) => x.Key).map(({ Key, Value }) => ({\n    key: getInspector(Key!).toObjectPreview(Key!),\n    value: getInspector(Value!).toObjectPreview(Value!),\n  })),\n});\nconst WeakSet = new ObjectInspector<WeakSetObject>('WeakSet', 'weakset', () => 'WeakSet', {\n  entries: (value) => value.WeakSetData.filter(globalThis.Boolean).map((Value) => ({\n    value: getInspector(Value!).toObjectPreview(Value!),\n  })),\n});\n\nconst Date = new ObjectInspector<DateObject>('Date', 'date', ((value: DateObject) => {\n  if (!globalThis.Number.isFinite(R(value.DateValue))) {\n    return 'Invalid Date';\n  }\n  const val = DateProto_toISOString([], { thisValue: value, NewTarget: Value.undefined });\n  return ValueOfNormalCompletion(val as NormalCompletion<JSStringValue>).stringValue();\n}));\nconst Promise = new ObjectInspector<PromiseObject>('Promise', 'promise', () => 'Promise', {\n  additionalProperties: (value) => [['[[PromiseState]]', Value(value.PromiseState)], ['[[PromiseResult]]', value.PromiseResult || Value.undefined]],\n});\nconst Proxy = new ObjectInspector<ProxyObject>('Proxy', 'proxy', (value) => {\n  if (IsCallable(value.ProxyTarget)) {\n    return 'Proxy(Function)';\n  }\n  if (value.ProxyTarget instanceof ObjectValue) {\n    return 'Proxy(Object)';\n  }\n  return 'Proxy';\n});\nconst RegExp = new ObjectInspector<RegExpObject>('RegExp', 'regexp', (value) => `/${value.OriginalSource.stringValue()}/${value.OriginalFlags.stringValue()}`);\nconst Module = new ObjectInspector<ModuleNamespaceObject>('Module', undefined, () => 'Module', {});\n\nconst Array: Inspector<ObjectValue> = {\n  toRemoteObject(value, getObjectId) {\n    return {\n      type: 'object',\n      className: 'Array',\n      subtype: 'array',\n      objectId: getObjectId(value),\n      description: getInspector(value).toDescription(value),\n      preview: this.toObjectPreview?.(value),\n    };\n  },\n  toPropertyPreview(name, value) {\n    return {\n      name, type: 'object', subtype: 'array', value: this.toDescription(value),\n    };\n  },\n  toObjectPreview(value) {\n    const result: Protocol.Runtime.ObjectPreview = {\n      type: 'object',\n      subtype: 'array',\n      overflow: false,\n      properties: [],\n      description: this.toDescription(value),\n    };\n    const indexProp: Protocol.Runtime.PropertyPreview[] = [];\n    const otherProp: Protocol.Runtime.PropertyPreview[] = [];\n    for (const [key, desc] of value.properties) {\n      if (indexProp.length > 100) {\n        result.overflow = true;\n        break;\n      }\n      if (isIntegerIndex(key)) {\n        indexProp.push(propertyToPropertyPreview(key, desc));\n      } else if (!(key instanceof JSStringValue && key.stringValue() === 'length')) {\n        otherProp.push(propertyToPropertyPreview(key, desc));\n      }\n    }\n    result.properties = indexProp.concat(otherProp).slice(0, 100);\n    return result;\n  },\n  toDescription(value) {\n    const length = [...value.properties.entries()].find(([key]) => key instanceof JSStringValue && key.stringValue() === 'length');\n    if (!length || !(length[1].Value instanceof NumberValue)) {\n      throw new TypeError('Bad ArrayExoticObject');\n    }\n    return `Array(${R(length[1].Value)})`;\n  },\n};\nconst TypedArray = new ObjectInspector<TypedArrayObject>('TypedArray', 'typedarray', (value) => `${value.TypedArrayName.stringValue()}(${value.ArrayLength})`);\n\nfunction propertyToPropertyPreview(key: PropertyKeyValue | PrivateName, desc: Descriptor | PrivateElementRecord): Protocol.Runtime.PropertyPreview {\n  let name;\n  if (key instanceof JSStringValue) {\n    name = key.stringValue();\n  } else if (key instanceof PrivateName) {\n    name = key.Description.stringValue();\n  } else {\n    name = SymbolDescriptiveString(key).stringValue();\n  }\n  if (desc.Get || desc.Set) {\n    return { name, type: 'accessor' };\n  } else {\n    return getInspector(desc.Value!).toPropertyPreview(name, desc.Value!);\n  }\n}\n\nfunction propertiesToPropertyPreview(value: ObjectValue, extra: undefined | Iterable<[string, Value]>, max = 5) {\n  let overflow = false;\n  const properties: Protocol.Runtime.PropertyPreview[] = [];\n  if (extra) {\n    for (const [key, value] of extra) {\n      properties.push(getInspector(value).toPropertyPreview(key, value));\n    }\n  }\n  if (isTypedArrayObject(value) && value.ViewedArrayBuffer instanceof ObjectValue && value.ViewedArrayBuffer.ArrayBufferData instanceof DataBlock) {\n    const record = MakeTypedArrayWithBufferWitnessRecord(value, 'seq-cst');\n    const length = TypedArrayLength(record);\n    for (let index = 0; index < length; index += 1) {\n      const index_value = TypedArrayGetElement(value, Value(index));\n      if (index_value instanceof UndefinedValue) {\n        break;\n      }\n      if (properties.length > 100) {\n        overflow = true;\n        break;\n      }\n      properties.push(getInspector(index_value).toPropertyPreview(index.toString(), index_value));\n    }\n    properties.push(\n      {\n        name: 'buffer', type: 'object', subtype: 'arraybuffer', value: `ArrayBuffer(${value.ViewedArrayBuffer.ArrayBufferData.byteLength})`,\n      },\n      { name: 'byteLength', type: 'number', value: globalThis.String(value.ArrayLength) },\n      { name: 'byteOffset', type: 'number', value: globalThis.String(value.ByteOffset) },\n      { name: 'length', type: 'number', value: globalThis.String(length) },\n    );\n  }\n  for (const [key, desc] of value.properties) {\n    if (properties.length > max) {\n      overflow = true;\n      break;\n    }\n    properties.push(propertyToPropertyPreview(key, desc));\n  }\n  for (const desc of value.PrivateElements) {\n    if (properties.length > max) {\n      overflow = true;\n      break;\n    }\n    properties.push(propertyToPropertyPreview(desc.Key, desc));\n  }\n  return { overflow, properties };\n}\n\nexport function getInspector(value: Value): Inspector<Value> {\n  switch (true) {\n    case value === Value.null:\n      return Null;\n    case value === Value.undefined:\n      return Undefined;\n    case value === Value.true || value === Value.false:\n      return Boolean;\n    case value instanceof SymbolValue:\n      return Symbol;\n    case value instanceof JSStringValue:\n      return String;\n    case value instanceof NumberValue:\n    case value instanceof BigIntValue:\n      return Number;\n    case isProxyExoticObject(value):\n      return Proxy;\n    case IsCallable(value):\n      return Function;\n    case isArrayExoticObject(value):\n      return Array;\n    case isRegExpObject(value):\n      return RegExp;\n    case isDateObject(value):\n      return Date;\n    case isMapObject(value):\n      return Map;\n    case isSetObject(value):\n      return Set;\n    case isWeakMapObject(value):\n      return WeakMap;\n    case isWeakSetObject(value):\n      return WeakSet;\n    // generator\n    case isErrorObject(value):\n      return Error;\n    case isPromiseObject(value):\n      return Promise;\n    case isTypedArrayObject(value):\n      return TypedArray;\n    case isArrayBufferObject(value):\n      return ArrayBuffer;\n    case isDataViewObject(value):\n      return DataView;\n    case isModuleNamespaceObject(value):\n      return Module;\n    default:\n      return Default;\n  }\n}\n","import type { Protocol } from 'devtools-protocol';\nimport { getInspector } from './inspect.mts';\nimport type { Inspector } from './index.mts';\nimport {\n  evalQ,\n  EnsureCompletion, IsPromise, JSStringValue, ManagedRealm, NullValue, ObjectValue, SymbolValue, ThrowCompletion, UndefinedValue, Value,\n  type PromiseObject,\n  getHostDefinedErrorStack,\n  skipDebugger,\n  type ValueCompletion,\n  getCurrentStack,\n  isECMAScriptFunctionObject,\n  SymbolDescriptiveString,\n  type EnvironmentRecordWithThisBinding,\n  EnvironmentRecord,\n  DeclarativeEnvironmentRecord,\n  ObjectEnvironmentRecord,\n  FunctionEnvironmentRecord,\n  GlobalEnvironmentRecord,\n  ModuleEnvironmentRecord,\n  OrdinaryObjectCreate,\n  Descriptor,\n  isArgumentExoticObject,\n  Agent,\n  surroundingAgent,\n  IsAccessorDescriptor,\n  isIntegerIndex,\n  isBuiltinFunctionObject,\n  isArrayBufferObject,\n  DataBlock,\n} from '#self';\n\ninterface InspectedRealmDescriptor {\n  readonly realm: ManagedRealm;\n  readonly descriptor: Protocol.Runtime.ExecutionContextDescription;\n  readonly agent: Agent;\n  detach(): void;\n}\nexport class InspectorContext {\n  #io: Inspector;\n\n  constructor(io: Inspector) {\n    this.#io = io;\n  }\n\n  realms: (InspectedRealmDescriptor | undefined)[] = [];\n\n  attachRealm(realm: ManagedRealm, agent: Agent) {\n    const id = this.realms.length;\n    const descriptor: Protocol.Runtime.ExecutionContextDescription = {\n      id,\n      origin: 'vm://realm',\n      name: 'engine262',\n      uniqueId: id.toString(),\n    };\n    this.realms.push({\n      realm,\n      descriptor,\n      agent,\n      detach: () => {\n        realm.HostDefined.attachingInspector = oldInspector;\n      },\n    });\n    const oldInspector = realm.HostDefined.attachingInspector;\n    realm.HostDefined.attachingInspector = this.#io;\n    const oldPromiseRejectionTracker = realm.HostDefined.promiseRejectionTracker;\n    realm.HostDefined.promiseRejectionTracker = (promise, operation) => {\n      oldPromiseRejectionTracker?.(promise, operation);\n      if (operation === 'reject') {\n        this.#io.sendEvent['Runtime.exceptionThrown']({\n          timestamp: Date.now(),\n          exceptionDetails: this.createExceptionDetails(promise, true),\n        });\n      } else {\n        const id = this.#exceptionMap.get(promise);\n        if (id) {\n          this.#io.sendEvent['Runtime.exceptionRevoked']({\n            reason: 'Handler added to rejected promise',\n            exceptionId: id,\n          });\n        }\n      }\n    };\n    this.#io.sendEvent['Runtime.executionContextCreated']({ context: descriptor });\n  }\n\n  detachAgent(agent: Agent) {\n    for (const realm of this.realms) {\n      if (realm?.agent === agent) {\n        this.detachRealm(realm.realm);\n      }\n    }\n  }\n\n  detachRealm(realm: ManagedRealm) {\n    const index = this.realms.findIndex((c) => c?.realm === realm);\n    if (index === -1) {\n      return;\n    }\n    const { descriptor } = this.realms[index]!;\n    realm.HostDefined.attachingInspector = undefined;\n    this.realms[index] = undefined;\n    this.#io.sendEvent['Runtime.executionContextDestroyed']({ executionContextId: descriptor.id, executionContextUniqueId: descriptor.uniqueId });\n  }\n\n  getRealm(realm: ManagedRealm | string | number | undefined) {\n    if (realm === undefined) {\n      if (surroundingAgent.runningExecutionContext && surroundingAgent.currentRealmRecord instanceof ManagedRealm) {\n        realm = surroundingAgent.currentRealmRecord;\n      } else {\n        return undefined;\n      }\n    }\n    if (typeof realm === 'string') {\n      return this.realms.find((c) => c?.descriptor.uniqueId === realm);\n    } else if (typeof realm === 'number') {\n      return this.realms[realm];\n    }\n    return this.realms.find((c) => c?.realm === realm);\n  }\n\n  /** @deprecated in this case we are guessing the realm should be using, which may create bad result */\n  getAnyRealm() {\n    return this.realms.find(Boolean);\n  }\n\n  #idToObject = new Map<string, ObjectValue | SymbolValue>();\n\n  // id 0 is falsy, skip it\n  #idToArrayBufferBlock: (undefined | ArrayBuffer)[] = [undefined];\n\n  #objectToId = new Map<ObjectValue | SymbolValue, string>();\n\n  #objectCounter = 1;\n\n  #internObject(object: ObjectValue | SymbolValue, group = 'default') {\n    if (this.#objectToId.has(object)) {\n      return this.#objectToId.get(object)!;\n    }\n    const id = `${group}:${this.#objectCounter}`;\n    this.#objectCounter += 1;\n    this.#idToObject.set(id, object);\n    this.#objectToId.set(object, id);\n    return id;\n  }\n\n  releaseObject(id: string) {\n    const object = this.#idToObject.get(id);\n    if (object) {\n      this.#idToObject.delete(id);\n      this.#objectToId.delete(object);\n    }\n  }\n\n  releaseObjectGroup(group: string) {\n    for (const [id, object] of this.#idToObject.entries()) {\n      if (id.startsWith(group)) {\n        this.#idToObject.delete(id);\n        this.#objectToId.delete(object);\n      }\n    }\n  }\n\n  getObject(objectId: string) {\n    return this.#idToObject.get(objectId);\n  }\n\n  toRemoteObject(value: Value, options: { objectGroup?: string, generatePreview?: boolean }): Protocol.Runtime.RemoteObject {\n    return getInspector(value).toRemoteObject(value, (val) => this.#internObject(val, options.objectGroup), options.generatePreview);\n  }\n\n  getProperties({\n    objectId, accessorPropertiesOnly, generatePreview, nonIndexedPropertiesOnly, ownProperties,\n  }: Protocol.Runtime.GetPropertiesRequest): Protocol.Runtime.GetPropertiesResponse {\n    const object = this.getObject(objectId);\n    if (!(object instanceof ObjectValue)) {\n      return { result: [] };\n    }\n    const wrap = (v: Value) => this.toRemoteObject(v, { generatePreview });\n\n    const properties: Protocol.Runtime.PropertyDescriptor[] = [];\n    const internalProperties: Protocol.Runtime.InternalPropertyDescriptor[] = [];\n    const privateProperties: Protocol.Runtime.PrivatePropertyDescriptor[] = [];\n\n    object.PrivateElements.forEach((value) => {\n      privateProperties.push({\n        name: value.Key.Description.stringValue(),\n        value: value.Value ? wrap(value.Value) : undefined,\n        get: value.Get ? wrap(value.Get) : undefined,\n        set: value.Set ? wrap(value.Set) : undefined,\n      });\n    });\n\n    const value = evalQ((Q) => {\n      let p: NullValue | ObjectValue = object;\n      while (p instanceof ObjectValue) {\n        for (const key of Q(skipDebugger(p.OwnPropertyKeys()))) {\n          if (nonIndexedPropertiesOnly && !isIntegerIndex(key)) {\n            continue;\n          }\n          const desc = Q(skipDebugger(p.GetOwnProperty(key)));\n          if (accessorPropertiesOnly && !IsAccessorDescriptor(desc)) {\n            continue;\n          }\n          if (desc instanceof UndefinedValue) {\n            return;\n          }\n          const descriptor: Protocol.Runtime.PropertyDescriptor = {\n            name: key instanceof JSStringValue\n              ? key.stringValue()\n              : SymbolDescriptiveString(key).stringValue(),\n            value: desc.Value && !('HostUninitializedBindingMarkerObject' in desc.Value) ? wrap(desc.Value) : undefined,\n            writable: desc.Writable === Value.true,\n            get: desc.Get ? wrap(desc.Get) : undefined,\n            set: desc.Set ? wrap(desc.Set) : undefined,\n            configurable: desc.Configurable === Value.true,\n            enumerable: desc.Enumerable === Value.true,\n            wasThrown: false,\n            isOwn: p === object,\n            symbol: key instanceof SymbolValue ? wrap(key) : undefined,\n          };\n          properties.push(descriptor);\n        }\n\n        if (ownProperties) {\n          break;\n        }\n        p = Q(skipDebugger(p.GetPrototypeOf()));\n      }\n    });\n    if (value.Type === 'throw') {\n      return {\n        result: [],\n        exceptionDetails: this.createExceptionDetails(value, false),\n      };\n    }\n\n    if (IsPromise(object) === Value.true) {\n      internalProperties.push({\n        name: '[[PromiseState]]',\n        value: {\n          type: 'string',\n          value: (object as PromiseObject).PromiseState,\n        },\n      });\n      internalProperties.push({\n        name: '[[PromiseResult]]',\n        value: wrap((object as PromiseObject).PromiseResult!),\n      });\n    }\n    if ('Prototype' in object) {\n      internalProperties.push({\n        name: '[[Prototype]]',\n        value: wrap(object.Prototype as Value),\n      });\n    }\n    if (isBuiltinFunctionObject(object) && object.nativeFunction.section) {\n      internalProperties.push({\n        name: '[[Section]]',\n        value: {\n          type: 'string',\n          value: object.nativeFunction.section,\n        },\n      });\n    }\n    if (isArrayBufferObject(object) && object.ArrayBufferData instanceof DataBlock) {\n      internalProperties.push({\n        name: '[[ArrayBufferByteLength]]',\n        value: {\n          type: 'number',\n          value: object.ArrayBufferByteLength,\n        },\n      });\n      this.#idToArrayBufferBlock.push(object.ArrayBufferData.buffer);\n      internalProperties.push({\n        name: '[[ArrayBufferData]]',\n        value: {\n          type: 'number',\n          value: this.#idToArrayBufferBlock.length - 1,\n        },\n      });\n    }\n\n    return { result: properties, internalProperties, privateProperties };\n  }\n\n  #exceptionMap = new WeakMap<Value, number>();\n\n  createExceptionDetails(completion: ThrowCompletion | Value, isPromise: boolean): Protocol.Runtime.ExceptionDetails {\n    const value = completion instanceof ThrowCompletion ? completion.Value : completion;\n    const stack = getHostDefinedErrorStack(value);\n    const frames: Protocol.Runtime.CallFrame[] = stack?.map((call) => call.toCallFrame()!).filter(Boolean) || [];\n    const exceptionId = this.#objectCounter;\n    this.#objectCounter += 1;\n    this.#exceptionMap.set(value, exceptionId);\n    return {\n      text: isPromise ? 'Uncaught (in promise)' : 'Uncaught',\n      stackTrace: stack ? { callFrames: frames } : undefined,\n      exception: getInspector(value).toRemoteObject(value, (val) => this.#internObject(val), false),\n      lineNumber: frames[0]?.lineNumber || 0,\n      columnNumber: frames[0]?.columnNumber || 0,\n      exceptionId,\n      scriptId: frames[0]?.scriptId,\n      url: frames[0]?.url,\n    };\n  }\n\n  createEvaluationResult(completion: ValueCompletion): Protocol.Runtime.EvaluateResponse {\n    completion = EnsureCompletion(completion);\n    if (!(completion.Value instanceof Value)) {\n      throw new RangeError('Invalid completion value');\n    }\n    return {\n      exceptionDetails: completion instanceof ThrowCompletion ? this.createExceptionDetails(completion, false) : undefined,\n      result: this.toRemoteObject(completion.Value, {}),\n    };\n  }\n\n  getDebuggerCallFrame(): Protocol.Debugger.CallFrame[] {\n    const stacks = getCurrentStack(false);\n    const length = surroundingAgent.executionContextStack.length;\n    return stacks.map((stack, index): Protocol.Debugger.CallFrame => {\n      if (!stack.getScriptId()) {\n        return undefined!;\n      }\n      const scopeChain: Protocol.Debugger.Scope[] = [];\n      let env: EnvironmentRecord | NullValue = stack.context.LexicalEnvironment;\n      while (env instanceof EnvironmentRecord) {\n        const result = getDisplayObjectFromEnvironmentRecord(env);\n        if (result) {\n          scopeChain.push({ type: result.type, object: this.toRemoteObject(result.object, {}) });\n        }\n        env = env.OuterEnv;\n      }\n      return {\n        callFrameId: String(length - index - 1),\n        functionName: stack.getFunctionName() || '<anonymous>',\n        location: {\n          scriptId: stack.getScriptId()!,\n          lineNumber: (stack.lineNumber || 1) - 1,\n          columnNumber: (stack.columnNumber || 1) - 1,\n        },\n        this: this.toRemoteObject(HostGetThisEnvironment(stack.context.LexicalEnvironment), {}),\n        url: stack.getSpecifier() || '',\n        canBeRestarted: false,\n        functionLocation: isECMAScriptFunctionObject(stack.context.Function) ? {\n          lineNumber: (stack.context.Function.ECMAScriptCode?.location.start.line || 1) - 1,\n          columnNumber: (stack.context.Function.ECMAScriptCode?.location.start.column || 1) - 1,\n          scriptId: stack.getScriptId() || '',\n        } : undefined,\n        scopeChain,\n      };\n    }).filter(Boolean);\n  }\n\n  evaluateMode: 'script' | 'module' | 'console' = 'script';\n}\n\nfunction HostGetThisEnvironment(env: EnvironmentRecord | NullValue): Value {\n  while (!(env instanceof NullValue)) {\n    const exists = env.HasThisBinding();\n    if (exists === Value.true) {\n      const value = (env as EnvironmentRecordWithThisBinding).GetThisBinding();\n      if (value instanceof ThrowCompletion) {\n        return Value.undefined;\n      }\n      return value as Value;\n    }\n    const outer = env.OuterEnv;\n    env = outer;\n  }\n  throw new ReferenceError('No this environment found');\n}\n\nfunction getDisplayObjectFromEnvironmentRecord(record: EnvironmentRecord): undefined | { type: Protocol.Debugger.Scope['type'], object: ObjectValue } {\n  if (record instanceof DeclarativeEnvironmentRecord) {\n    const object = OrdinaryObjectCreate(Value.null, ['HostInspectorScopePreview']);\n    for (const [key, binding] of record.bindings) {\n      const value = binding.initialized ? binding.value! : OrdinaryObjectCreate(Value.null, ['HostUninitializedBindingMarkerObject']);\n      if (isArgumentExoticObject(value)) {\n        continue;\n      }\n      object.properties.set(key, Descriptor({\n        Enumerable: isArgumentExoticObject(value) ? Value.false : Value.true,\n        Value: value,\n        Writable: binding.mutable ? Value.true : Value.false,\n      }));\n    }\n    let type: Protocol.Debugger.Scope['type'] = 'block';\n    if (record instanceof FunctionEnvironmentRecord) {\n      type = 'local';\n    } else if (record instanceof ModuleEnvironmentRecord) {\n      type = 'module';\n    }\n    if (type !== 'local' && !object.properties.size) {\n      return undefined;\n    }\n    return { type, object };\n  } else if (record instanceof ObjectEnvironmentRecord) {\n    return { type: record.IsWithEnvironment === Value.true ? 'with' : 'global', object: record.BindingObject };\n  } else if (record instanceof GlobalEnvironmentRecord) {\n    return { type: 'global', object: record.GlobalThisValue };\n  }\n  throw new TypeError('Unknown environment record');\n}\n","import type { Protocol } from 'devtools-protocol';\nimport { SourceTextModuleRecord, type ScriptRecord } from '#self';\n\nexport function getParsedEvent(source: ScriptRecord | SourceTextModuleRecord, id: string, executionContextId: number): Protocol.Debugger.ScriptParsedEvent {\n  const lines = source.ECMAScriptCode.sourceText().split('\\n');\n  return {\n    isModule: source instanceof SourceTextModuleRecord,\n    scriptId: id,\n    url: source.HostDefined.specifier || `vm:///${id}`,\n    startLine: 0,\n    startColumn: 0,\n    endLine: lines.length,\n    endColumn: lines.pop()!.length,\n    executionContextId,\n    hash: '',\n    buildId: '',\n  };\n}\n","import type { Protocol } from 'devtools-protocol';\nimport type {\n  DebuggerContext,\n  DebuggerNamespace, HeapProfilerNamespace, ProfilerNamespace, RuntimeNamespace,\n} from './types.mts';\nimport { getParsedEvent } from './internal-utils.mts';\nimport type { InspectorContext } from './context.mts';\nimport {\n  Call, NormalCompletion, ObjectValue, ParseScript, runJobQueue, ScriptRecord, surroundingAgent, ThrowCompletion, skipDebugger, Value, type FunctionObject,\n  ParseModule,\n  SourceTextModuleRecord, performDevtoolsEval,\n  ValueOfNormalCompletion,\n  JSStringValue,\n  evalQ,\n  Assert,\n  kInternal,\n} from '#self';\n\nexport const Debugger: DebuggerNamespace = {\n  enable(_req, { onDebuggerAttached }) {\n    onDebuggerAttached();\n    return { debuggerId: 'debugger.0' };\n  },\n  getScriptSource({ scriptId }) {\n    const source = surroundingAgent.parsedSources.get(scriptId);\n    if (!source) {\n      throw new Error('Not found');\n    }\n    return { scriptSource: source.ECMAScriptCode.sourceText() };\n  },\n  setAsyncCallStackDepth() { },\n  setBlackboxPatterns() { },\n  setPauseOnExceptions() { },\n  setBlackboxExecutionContexts() { },\n  setBreakpointByUrl() {\n    return { breakpointId: '0', locations: [] };\n  },\n  stepInto(_, { sendEvent }) {\n    sendEvent['Debugger.resumed']();\n    surroundingAgent.resumeEvaluate({ pauseAt: 'step-in' });\n  },\n  resume(_, { sendEvent }) {\n    sendEvent['Debugger.resumed']();\n    surroundingAgent.resumeEvaluate();\n  },\n  stepOver(_req, { sendEvent }) {\n    sendEvent['Debugger.resumed']();\n    surroundingAgent.resumeEvaluate({ pauseAt: 'step-over' });\n  },\n  stepOut(_req, { sendEvent }) {\n    sendEvent['Debugger.resumed']();\n    surroundingAgent.resumeEvaluate({ pauseAt: 'step-out' });\n  },\n  evaluateOnCallFrame(req, context) {\n    return evaluate({\n      ...req,\n      uniqueContextId: context.context.getRealm(undefined)!.descriptor.uniqueId,\n      evalMode: context.context.evaluateMode,\n    }, context);\n  },\n  engine262_setEvaluateMode({ mode }, { context }) {\n    if (mode === 'module' || mode === 'script' || mode === 'console') {\n      context.evaluateMode = mode;\n    }\n  },\n  engine262_setFeatures() {\n    throw new Error('Method should not be implemented here.');\n  },\n};\nexport const Profiler: ProfilerNamespace = {\n  enable() { },\n};\nexport const Runtime: RuntimeNamespace = {\n  discardConsoleEntries() { },\n  enable() {},\n  compileScript(options, { context, sendEvent }) {\n    let parsed!: ScriptRecord | SourceTextModuleRecord | ObjectValue[];\n    let realm = context.getRealm(options.executionContextId);\n    if (!realm && !options.persistScript) {\n      realm = context.getAnyRealm();\n    }\n    if (!realm) {\n      return unsupportedError;\n    }\n    realm.realm.scope(() => {\n      if (context.evaluateMode === 'module') {\n        parsed = ParseModule(options.expression, realm.realm, { specifier: options.sourceURL, doNotTrackScriptId: !options.persistScript });\n      } else {\n        parsed = ParseScript(options.expression, realm.realm, { specifier: options.sourceURL, doNotTrackScriptId: !options.persistScript, [kInternal]: { allowAllPrivateNames: true } });\n      }\n    });\n    if (!parsed) {\n      throw new Error('No parsed result');\n    }\n    if (Array.isArray(parsed)) {\n      const e = context.createExceptionDetails(ThrowCompletion(parsed[0]), false);\n      // Note: it has to be this message to trigger devtools' line wrap.\n      e.exception!.description = 'SyntaxError: Unexpected end of input';\n      return { exceptionDetails: e };\n    }\n    if (options.persistScript) {\n      if (realm?.descriptor.id === undefined) {\n        throw new Error('No realm id found');\n      }\n      const event = getParsedEvent(parsed, parsed.HostDefined.scriptId!, realm.descriptor.id);\n      sendEvent['Debugger.scriptParsed'](event);\n      return { scriptId: event.scriptId };\n    }\n    return {};\n  },\n  callFunctionOn(options, { context }): Protocol.Runtime.CallFunctionOnResponse {\n    const realmDesc = context.getRealm(options.uniqueContextId || options.executionContextId) || context.getAnyRealm();\n    if (!realmDesc) {\n      throw new Error('No realm found');\n    }\n    const { Value: F } = realmDesc.realm.evaluateScript(`(${options.functionDeclaration})`, { doNotTrackScriptId: true }) as NormalCompletion<FunctionObject>;\n    const thisValue = options.objectId\n      ? context.getObject(options.objectId)!\n      : Value.undefined;\n    const args = options.arguments?.map((a) => {\n      // TODO: revisit\n      if ('value' in a) {\n        return Value(a.value);\n      }\n      if (a.objectId) {\n        return context.getObject(a.objectId)!;\n      }\n      if ('unserializableValue' in a) {\n        throw new RangeError();\n      }\n      return Value.undefined;\n    });\n    return realmDesc.realm.scope((): Protocol.Runtime.CallFunctionOnResponse => {\n      const completion = evalQ((Q, X): Protocol.Runtime.CallFunctionOnResponse => {\n        const r = Q(skipDebugger(Call(F, thisValue, args || [])));\n        if (options.returnByValue) {\n          const value = X(Call(realmDesc.realm.Intrinsics['%JSON.stringify%'], Value.undefined, [r]));\n          if (value instanceof JSStringValue) {\n            const valueRealized = JSON.parse(value.stringValue());\n            return { result: { type: typeof value, value: valueRealized } };\n          }\n        }\n        return context.createEvaluationResult(r);\n      });\n      if (completion instanceof ThrowCompletion) {\n        return { result: { type: 'undefined' }, exceptionDetails: context.createExceptionDetails(completion, false) };\n      }\n      return completion.Value;\n    });\n  },\n  evaluate(options, context) {\n    return evaluate({\n      ...options,\n      evalMode: context.context.evaluateMode,\n      uniqueContextId: options.uniqueContextId!,\n    }, context);\n  },\n  getExceptionDetails(req, { context }) {\n    const object = context.getObject(req.errorObjectId)!;\n    if (object instanceof ObjectValue) {\n      return {\n        exceptionDetails: context.createExceptionDetails(ThrowCompletion(object), false),\n      };\n    }\n    return {\n      exceptionDetails: {\n        text: 'unsupported', lineNumber: 0, columnNumber: 0, exceptionId: 0,\n      },\n    };\n  },\n  getHeapUsage() {\n    return {\n      usedSize: 0, totalSize: 0, backingStorageSize: 0, embedderHeapUsedSize: 0,\n    };\n  },\n  getIsolateId() {\n    return { id: 'isolate.0' };\n  },\n  getProperties(options, { context }) {\n    return context.getProperties(options);\n  },\n  globalLexicalScopeNames({ executionContextId }, { context }) {\n    const global = context.getRealm(executionContextId)?.realm.GlobalObject;\n    if (!global) {\n      return { names: [] };\n    }\n    const keys = skipDebugger(global.OwnPropertyKeys());\n    if (keys instanceof ThrowCompletion) {\n      return { names: [] };\n    }\n    return { names: ValueOfNormalCompletion(keys).map((k) => (k instanceof JSStringValue ? k.stringValue() : null!)).filter(Boolean) };\n  },\n  releaseObject(req, { context }) {\n    context.releaseObject(req.objectId);\n  },\n  releaseObjectGroup({ objectGroup }, { context }) {\n    context.releaseObjectGroup(objectGroup);\n  },\n  runIfWaitingForDebugger() { },\n};\nexport const HeapProfiler: HeapProfilerNamespace = {\n  enable() { },\n  collectGarbage() { },\n};\n\nconst unsupportedError: Protocol.Runtime.EvaluateResponse = {\n  result: { type: 'undefined' },\n  exceptionDetails: {\n    text: 'unsupported', lineNumber: 0, columnNumber: 0, exceptionId: 0,\n  },\n};\nfunction evaluate(options: {\n  uniqueContextId: string,\n  expression: string,\n  evalMode: InspectorContext['evaluateMode'],\n  throwOnSideEffect?: boolean,\n  awaitPromise?: boolean,\n  callFrameId?: string,\n}, _context: DebuggerContext): Protocol.Runtime.EvaluateResponse | Promise<Protocol.Runtime.EvaluateResponse> {\n  const { context } = _context;\n  const isPreview = options.throwOnSideEffect;\n  if (options.awaitPromise) {\n    return unsupportedError;\n  }\n  const realm = context.getRealm(options.uniqueContextId);\n  if (!realm) {\n    return unsupportedError;\n  }\n\n  const isCallOnFrame = typeof options.callFrameId === 'string';\n  let callOnFramePoppedLevel = 0;\n  const oldExecutionStack = [...surroundingAgent.executionContextStack];\n  if (isCallOnFrame) {\n    const frame = surroundingAgent.executionContextStack[options.callFrameId as `${number}`];\n    if (!frame) {\n      // eslint-disable-next-line no-console\n      console.error('Execution context not found: ', options.callFrameId);\n      return unsupportedError;\n    }\n    for (const currentFrame of [...surroundingAgent.executionContextStack].reverse()) {\n      if (currentFrame === frame) {\n        break;\n      }\n      callOnFramePoppedLevel += 1;\n      surroundingAgent.executionContextStack.pop(currentFrame);\n    }\n  }\n  const promise = new Promise<Protocol.Runtime.EvaluateResponse>((resolve) => {\n    let toBeEvaluated;\n    if (isPreview || options.evalMode === 'console' || isCallOnFrame) {\n      toBeEvaluated = performDevtoolsEval(options.expression, realm.realm, false, !!(isPreview || isCallOnFrame));\n    } else {\n      let parsed!: ScriptRecord | SourceTextModuleRecord | ObjectValue[];\n      const realm = context.getRealm(options.uniqueContextId);\n      realm?.realm.scope(() => {\n        if (options.evalMode === 'module') {\n          parsed = ParseModule(options.expression, realm.realm);\n        } else {\n          parsed = ParseScript(options.expression, realm.realm);\n        }\n      });\n      if (Array.isArray(parsed)) {\n        const e = context.createExceptionDetails(ThrowCompletion(parsed[0]), false);\n        // Note: it has to be this message to trigger devtools' line wrap.\n        e.exception!.description = 'SyntaxError: Unexpected end of input';\n        resolve({ exceptionDetails: e, result: { type: 'undefined' } });\n        return;\n      }\n      toBeEvaluated = parsed;\n    }\n\n    const noDebuggerEvaluate = () => {\n      if (!('next' in toBeEvaluated)) {\n        throw new Assert.Error('Unexpected');\n      }\n      resolve(context.createEvaluationResult(skipDebugger(toBeEvaluated)));\n    };\n    if (isPreview) {\n      surroundingAgent.debugger_scopePreview(noDebuggerEvaluate);\n      return;\n    }\n    if (isCallOnFrame) {\n      noDebuggerEvaluate();\n      return;\n    }\n\n    const completion = realm.realm.evaluate(toBeEvaluated, (completion) => {\n      resolve(context.createEvaluationResult(completion));\n      runJobQueue();\n    });\n    if (completion) {\n      return;\n    }\n    surroundingAgent.resumeEvaluate();\n  });\n  promise.then(() => {\n    if (callOnFramePoppedLevel) {\n      Assert(oldExecutionStack.length - callOnFramePoppedLevel === surroundingAgent.executionContextStack.length);\n      for (const [newIndex, newStack] of surroundingAgent.executionContextStack.entries()) {\n        Assert(newStack === oldExecutionStack[newIndex]);\n      }\n      surroundingAgent.executionContextStack.length = 0;\n      for (const stack of oldExecutionStack) {\n        surroundingAgent.executionContextStack.push(stack);\n      }\n    }\n  });\n  return promise;\n}\n","import type Protocol from 'devtools-protocol';\nimport { Inspector } from './index.mts';\nimport {\n  CreateBuiltinFunction, CreateDataProperty, DefinePropertyOrThrow, Descriptor, NormalCompletion, OrdinaryObjectCreate, surroundingAgent, ThrowCompletion, skipDebugger, Value, type Arguments, type ManagedRealm,\n} from '#self';\n\nconst consoleMethods = [\n  'log',\n  'debug',\n  'info',\n  'error',\n  'warning',\n  'dir',\n  'dirxml',\n  'table',\n  'trace',\n  'clear',\n  'startGroup',\n  'startGroupCollapsed',\n  'endGroup',\n  'assert',\n  'profile',\n  'profileEnd',\n  'count',\n  'timeEnd',\n] as const;\ntype ConsoleMethod = typeof consoleMethods[number];\nexport function createConsole(realm: ManagedRealm, defaultBehaviour: Partial<Record<ConsoleMethod, (args: Arguments) => void | NormalCompletion<void>>>) {\n  realm.scope(() => {\n    const console = OrdinaryObjectCreate(realm.Intrinsics['%Object.prototype%']);\n    skipDebugger(DefinePropertyOrThrow(\n      realm.GlobalObject,\n      Value('console'),\n      Descriptor({\n        Configurable: Value.true,\n        Enumerable: Value.false,\n        Writable: Value.true,\n        Value: console,\n      }),\n    ));\n    consoleMethods.forEach((method) => {\n      const f = CreateBuiltinFunction(\n        (args) => {\n          if (surroundingAgent.debugger_isPreviewing) {\n            return Value.undefined;\n          }\n          if (defaultBehaviour[method]) {\n            const completion = (defaultBehaviour[method](args));\n            if (completion instanceof ThrowCompletion) {\n              return completion;\n            }\n          }\n          if (realm.HostDefined.attachingInspector instanceof Inspector) {\n            realm.HostDefined.attachingInspector.console(realm, method as Protocol.Protocol.Runtime.ConsoleAPICalledEventType, args);\n          }\n          return Value.undefined;\n        },\n        1,\n        Value(method),\n        [],\n      );\n      skipDebugger(CreateDataProperty(console, Value(method), f));\n    });\n  });\n}\n","import type { Protocol } from 'devtools-protocol';\nimport { InspectorContext } from './context.mts';\nimport * as impl from './methods.mts';\nimport type { DebuggerContext, DebuggerPreference, DevtoolEvents } from './types.mts';\nimport { getParsedEvent } from './internal-utils.mts';\nimport { Agent, type Arguments, type ManagedRealm } from '#self';\n\nconst ignoreNamespaces = ['Network'];\nconst ignoreMethods: string[] = [];\n\nexport type { DebuggerPreference } from './types.mts';\nexport { createConsole } from './utils.mts';\n\ninterface AgentRecord {\n  readonly agent: Agent;\n  onDetach(): void;\n}\nexport abstract class Inspector {\n  #context = new InspectorContext(this);\n\n  #agents: AgentRecord[] = [];\n\n  attachAgent(agent: Agent, priorRealms: ManagedRealm[]) {\n    const oldOnDebugger = agent.hostDefinedOptions.onDebugger;\n    agent.hostDefinedOptions.onDebugger = () => {\n      oldOnDebugger?.();\n      this.sendEvent['Debugger.paused']({\n        reason: 'debugCommand',\n        callFrames: this.#context.getDebuggerCallFrame(),\n      });\n    };\n\n    const oldOnRealmCreated = agent.hostDefinedOptions.onRealmCreated;\n    agent.hostDefinedOptions.onRealmCreated = (realm) => {\n      oldOnRealmCreated?.(realm);\n      this.#context.attachRealm(realm, agent);\n    };\n\n    const oldOnScriptParsed = agent.hostDefinedOptions.onScriptParsed;\n    agent.hostDefinedOptions.onScriptParsed = (script, id) => {\n      oldOnScriptParsed?.(script, id);\n      const realmId = this.#context.getRealm(script.Realm as ManagedRealm)?.descriptor.id;\n      if (realmId === undefined) {\n        return;\n      }\n      this.sendEvent['Debugger.scriptParsed'](getParsedEvent(script, id, realmId));\n    };\n    this.#agents.push({\n      agent,\n      onDetach: () => {\n        agent.hostDefinedOptions.onDebugger = oldOnDebugger;\n        agent.hostDefinedOptions.onRealmCreated = oldOnRealmCreated;\n        agent.hostDefinedOptions.onScriptParsed = oldOnScriptParsed;\n        this.#agents = this.#agents.filter((x) => x.agent !== agent);\n      },\n    });\n    priorRealms.forEach((realm) => {\n      this.#context.attachRealm(realm, agent);\n    });\n  }\n\n  detachAgent(agent: Agent) {\n    const record = this.#agents.find((x) => x.agent === agent);\n    record?.onDetach();\n    this.#context.detachAgent(agent);\n  }\n\n  protected abstract send(data: object): void;\n\n  readonly preference: DebuggerPreference = { previewDebug: false };\n\n  protected onMessage(id: unknown, methodArg: string, params: unknown): void {\n    if (ignoreMethods.includes(methodArg)) {\n      return;\n    }\n    const [namespace, method] = methodArg.split('.');\n    if (ignoreNamespaces.includes(namespace)) {\n      return;\n    }\n    if (!(namespace in impl)) {\n      // eslint-disable-next-line no-console\n      console.error(`Unknown namespace requested: ${namespace}`);\n      return;\n    }\n    const ns = (impl as Record<string, object>)[namespace];\n    if (!(method in ns)) {\n      // eslint-disable-next-line no-console\n      console.error(`Unknown method requested: ${namespace}.${method}`);\n      return;\n    }\n\n    const f = (ns as Record<string, (args: unknown, context: DebuggerContext) => unknown>)[method];\n    new Promise((resolve) => {\n      resolve(f(params, this.#debugContext));\n    }).then((result = {}) => {\n      this.send({ id, result });\n    });\n  }\n\n  sendEvent: DevtoolEvents = Object.create(new Proxy({}, {\n    get: (_, key: string) => {\n      const f = (params: Record<string, unknown>) => {\n        this.send({ method: key, params });\n      };\n      Object.defineProperty(this.sendEvent, key, { value: f });\n      return f;\n    },\n  }));\n\n  console(realm: ManagedRealm, type: Protocol.Runtime.ConsoleAPICalledEventType, args: Arguments) {\n    const context = this.#context.getRealm(realm);\n    if (!context) {\n      return;\n    }\n    this.sendEvent['Runtime.consoleAPICalled']({\n      type,\n      args: args.map((x) => this.#context.toRemoteObject(x, { })),\n      executionContextId: context.descriptor.id,\n      timestamp: Date.now(),\n    });\n  }\n\n  #debugContext: DebuggerContext = {\n    sendEvent: this.sendEvent,\n    preference: this.preference,\n    context: this.#context,\n    onDebuggerAttached: () => {\n      this.#context.realms.forEach((realm) => {\n        if (realm) {\n          this.sendEvent['Runtime.executionContextCreated']({\n            context: realm.descriptor,\n          });\n        }\n      });\n    },\n  };\n}\n"],"names":["Null","toRemoteObject","type","subtype","value","toObjectPreview","properties","overflow","toPropertyPreview","name","toDescription","Undefined","Boolean","booleanValue","toString","description","Symbol","getObjectId","SymbolDescriptiveString","stringValue","objectId","String","Number","v","R","isNeg0","Object","is","globalThis","isFinite","unserializableValue","r","BigIntValue","Function","result","IntrinsicsFunctionToString","isECMAScriptFunctionObject","ECMAScriptCode","className","ObjectInspector","toEntries","additionalProperties","constructor","additionalOptions","entries","preview","e","length","undefined","propertiesToPropertyPreview","Default","ArrayBuffer","ArrayBufferByteLength","DataView","ByteLength","Error","text","surroundingAgent","debugger_scopePreview","evalQ","Q","ObjectValue","stack","skipDebugger","Get","Value","ToString","Map","MapData","filter","x","Key","map","key","getInspector","Set","SetData","WeakMap","WeakMapData","WeakSet","WeakSetData","Date","DateValue","val","DateProto_toISOString","thisValue","NewTarget","ValueOfNormalCompletion","Promise","PromiseState","PromiseResult","Proxy","IsCallable","ProxyTarget","RegExp","OriginalSource","OriginalFlags","Module","Array","indexProp","otherProp","desc","isIntegerIndex","push","propertyToPropertyPreview","JSStringValue","concat","slice","find","NumberValue","TypeError","TypedArray","TypedArrayName","ArrayLength","PrivateName","Description","extra","max","isTypedArrayObject","ViewedArrayBuffer","ArrayBufferData","DataBlock","record","MakeTypedArrayWithBufferWitnessRecord","TypedArrayLength","index","index_value","TypedArrayGetElement","UndefinedValue","byteLength","ByteOffset","PrivateElements","null","true","false","SymbolValue","isProxyExoticObject","isArrayExoticObject","isRegExpObject","isDateObject","isMapObject","isSetObject","isWeakMapObject","isWeakSetObject","isErrorObject","isPromiseObject","isArrayBufferObject","isDataViewObject","isModuleNamespaceObject","InspectorContext","io","realms","attachRealm","realm","agent","id","descriptor","origin","uniqueId","detach","HostDefined","attachingInspector","oldInspector","oldPromiseRejectionTracker","promiseRejectionTracker","promise","operation","sendEvent","timestamp","now","exceptionDetails","createExceptionDetails","get","reason","exceptionId","context","detachAgent","detachRealm","findIndex","c","executionContextId","executionContextUniqueId","getRealm","runningExecutionContext","currentRealmRecord","ManagedRealm","getAnyRealm","#internObject","object","group","has","set","releaseObject","delete","releaseObjectGroup","startsWith","getObject","options","objectGroup","generatePreview","getProperties","accessorPropertiesOnly","nonIndexedPropertiesOnly","ownProperties","wrap","internalProperties","privateProperties","forEach","p","OwnPropertyKeys","GetOwnProperty","IsAccessorDescriptor","writable","Writable","configurable","Configurable","enumerable","Enumerable","wasThrown","isOwn","symbol","GetPrototypeOf","Type","IsPromise","Prototype","isBuiltinFunctionObject","nativeFunction","section","buffer","completion","isPromise","ThrowCompletion","getHostDefinedErrorStack","frames","call","toCallFrame","stackTrace","callFrames","exception","lineNumber","columnNumber","scriptId","url","createEvaluationResult","EnsureCompletion","RangeError","getDebuggerCallFrame","stacks","getCurrentStack","executionContextStack","getScriptId","scopeChain","env","LexicalEnvironment","EnvironmentRecord","getDisplayObjectFromEnvironmentRecord","OuterEnv","callFrameId","functionName","getFunctionName","location","this","HostGetThisEnvironment","getSpecifier","canBeRestarted","functionLocation","start","line","column","evaluateMode","NullValue","exists","HasThisBinding","GetThisBinding","outer","ReferenceError","DeclarativeEnvironmentRecord","OrdinaryObjectCreate","binding","bindings","initialized","isArgumentExoticObject","Descriptor","mutable","FunctionEnvironmentRecord","ModuleEnvironmentRecord","size","ObjectEnvironmentRecord","IsWithEnvironment","BindingObject","GlobalEnvironmentRecord","GlobalThisValue","getParsedEvent","source","lines","sourceText","split","isModule","SourceTextModuleRecord","specifier","startLine","startColumn","endLine","endColumn","pop","hash","buildId","Debugger","enable","_req","onDebuggerAttached","debuggerId","getScriptSource","parsedSources","scriptSource","setAsyncCallStackDepth","setBlackboxPatterns","setPauseOnExceptions","setBlackboxExecutionContexts","setBreakpointByUrl","breakpointId","locations","stepInto","_","resumeEvaluate","pauseAt","resume","stepOver","stepOut","evaluateOnCallFrame","req","evaluate","uniqueContextId","evalMode","engine262_setEvaluateMode","mode","engine262_setFeatures","Profiler","Runtime","discardConsoleEntries","compileScript","parsed","persistScript","unsupportedError","scope","ParseModule","expression","sourceURL","doNotTrackScriptId","ParseScript","kInternal","allowAllPrivateNames","isArray","event","callFunctionOn","realmDesc","F","evaluateScript","functionDeclaration","args","arguments","a","X","Call","returnByValue","Intrinsics","valueRealized","JSON","parse","getExceptionDetails","errorObjectId","getHeapUsage","usedSize","totalSize","backingStorageSize","embedderHeapUsedSize","getIsolateId","globalLexicalScopeNames","global","GlobalObject","names","keys","k","runIfWaitingForDebugger","HeapProfiler","collectGarbage","_context","isPreview","throwOnSideEffect","awaitPromise","isCallOnFrame","callOnFramePoppedLevel","oldExecutionStack","frame","console","error","currentFrame","reverse","resolve","toBeEvaluated","performDevtoolsEval","noDebuggerEvaluate","Assert","runJobQueue","then","newIndex","newStack","consoleMethods","createConsole","defaultBehaviour","DefinePropertyOrThrow","method","f","CreateBuiltinFunction","debugger_isPreviewing","Inspector","CreateDataProperty","ignoreNamespaces","ignoreMethods","attachAgent","priorRealms","oldOnDebugger","hostDefinedOptions","onDebugger","oldOnRealmCreated","onRealmCreated","oldOnScriptParsed","onScriptParsed","script","realmId","Realm","onDetach","preference","previewDebug","onMessage","methodArg","params","includes","namespace","impl","ns","send","create","defineProperty"],"mappings":"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"}